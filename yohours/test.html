<!DOCTYPE html5>
<html>
<!--
	This file is part of YoHours.

	YoHours is free software: you can redistribute it and/or modify
	it under the terms of the GNU Affero General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	any later version.

	YoHours is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU Affero General Public License for more details.

	You should have received a copy of the GNU Affero General Public License
	along with YoHours. If not, see <http://www.gnu.org/licenses/>.
-->
<!--
	YoHours
	Web interface to make opening hours data for OpenStreetMap the easy way
	Author: Adrien PAVIE
	
	Test runner page
-->
<head>
	<!-- General definitions -->
	<title>YoHours (Test page)</title>
	<meta charset="utf-8" />

	<!-- jQuery includes -->
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
	<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
	
	<!-- FullCalendar includes -->
	<script src="lib/moment.js"></script>
	<link rel='stylesheet' href='lib/fullcalendar/fullcalendar.css' />
	<script src='lib/fullcalendar/fullcalendar.js'></script>
	
	<!-- opening_hours.js includes -->
	<script src="lib/opening_hours.js"></script>
	
	<!-- QUnit includes -->
	<link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-1.18.0.css">
	<script src="https://code.jquery.com/qunit/qunit-1.18.0.js"></script>
	
	<!-- YoHours includes -->
	<script type="text/javascript">
		YoHours = function() {};
	</script>
	<script src="js/utils.js" type="text/javascript"></script>
	<script src="js/model.js" type="text/javascript"></script>
	<script src="js/view.js" type="text/javascript"></script>
	<script src="js/controller.js" type="text/javascript"></script>
	
	<!-- Tests -->
	<script>
		/*********
		 * Model *
		 *********/
		
		/*
		 * Interval
		 */
		QUnit.module("Model > Interval");
		QUnit.test("Constructor", function(assert) {
			assert.ok(new Interval(0,0,0,60));
		});
		QUnit.test("Basic", function(assert) {
			var interval = new Interval(0,1,2,3);
			assert.equal(interval.getStartDay(), 0);
			assert.equal(interval.getEndDay(), 1);
			assert.equal(interval.getFrom(), 2);
			assert.equal(interval.getTo(), 3);
		});
		QUnit.test("End as monday midnight", function(assert) {
			var interval = new Interval(5,0,60,0);
			assert.equal(interval.getStartDay(), 5);
			assert.equal(interval.getEndDay(), 6);
			assert.equal(interval.getFrom(), 60);
			assert.equal(interval.getTo(), 24*60);
		});
		
		/*
		 * WideInterval
		 */
		QUnit.module("Model > WideInterval");
		QUnit.test("Constructor day", function(assert) {
			var wi1 = new WideInterval().day(1,1,2,2);
			assert.ok(true);
			
			var wi2 = new WideInterval().day(1,1);
			assert.ok(true);
			
			try {
				var wi3 = new WideInterval().day();
				assert.ok(false);
			}
			catch(e) {
				assert.ok(true);
			}
		});
		QUnit.test("Constructor week", function(assert) {
			var wi1 = new WideInterval().week(1,5);
			assert.ok(true);
			
			var wi2 = new WideInterval().week(1);
			assert.ok(true);
			
			try {
				var wi3 = new WideInterval().week();
				assert.ok(false);
			}
			catch(e) {
				assert.ok(true);
			}
		});
		QUnit.test("Constructor month", function(assert) {
			var wi1 = new WideInterval().month(1,5);
			assert.ok(true);
			
			var wi2 = new WideInterval().month(1);
			assert.ok(true);
			
			try {
				var wi3 = new WideInterval().month();
				assert.ok(false);
			}
			catch(e) {
				assert.ok(true);
			}
		});
		QUnit.test("Constructor holiday", function(assert) {
			var wi1 = new WideInterval().holiday("PH");
			assert.ok(true);
			
			var wi2 = new WideInterval().holiday("SH");
			assert.ok(true);
			
			var wi3 = new WideInterval().holiday("easter");
			assert.ok(true);
			
			try {
				var wi4 = new WideInterval().holiday();
				assert.ok(false);
			}
			catch(e) {
				assert.ok(true);
			}
			
			try {
				var wi5 = new WideInterval().holiday("Invalid holiday");
				assert.ok(false);
			}
			catch(e) {
				assert.ok(true);
			}
		});
		QUnit.test("Constructor always", function(assert) {
			var wi1 = new WideInterval().always();
			assert.ok(true);
		});
		QUnit.test("Get type always", function(assert) {
			var wi1 = new WideInterval().always();
			assert.equal(wi1.getType(), "always");
		});
		QUnit.test("Get type day", function(assert) {
			var wi1 = new WideInterval().day(1,1);
			assert.equal(wi1.getType(), "day");
		});
		QUnit.test("Get type week", function(assert) {
			var wi1 = new WideInterval().week(5);
			assert.equal(wi1.getType(), "week");
		});
		QUnit.test("Get type month", function(assert) {
			var wi1 = new WideInterval().month(12);
			assert.equal(wi1.getType(), "month");
		});
		QUnit.test("Get type holiday", function(assert) {
			var wi1 = new WideInterval().holiday("SH");
			assert.equal(wi1.getType(), "holiday");
		});
		QUnit.test("Equals identical", function(assert) {
			var wi1 = new WideInterval().holiday("SH");
			assert.ok(wi1.equals(wi1));
		});
		QUnit.test("Equals same holiday", function(assert) {
			var wi1 = new WideInterval().holiday("SH");
			var wi2 = new WideInterval().holiday("SH");
			assert.ok(wi1.equals(wi2));
			assert.ok(wi2.equals(wi1));
		});
		QUnit.test("Equals same day", function(assert) {
			var wi1 = new WideInterval().day(1,2,3,4);
			var wi2 = new WideInterval().day(1,2,3,4);
			assert.ok(wi1.equals(wi2));
			assert.ok(wi2.equals(wi1));
		});
		QUnit.test("Equals same week", function(assert) {
			var wi1 = new WideInterval().week(1,2);
			var wi2 = new WideInterval().week(1,2);
			assert.ok(wi1.equals(wi2));
			assert.ok(wi2.equals(wi1));
		});
		QUnit.test("Equals same month", function(assert) {
			var wi1 = new WideInterval().month(1,2);
			var wi2 = new WideInterval().month(1,2);
			assert.ok(wi1.equals(wi2));
			assert.ok(wi2.equals(wi1));
		});
		QUnit.test("Equals same always", function(assert) {
			var wi1 = new WideInterval().always();
			var wi2 = new WideInterval().always();
			assert.ok(wi1.equals(wi2));
			assert.ok(wi2.equals(wi1));
		});
		QUnit.test("Equals different 1", function(assert) {
			var wi1 = new WideInterval().always();
			var wi2 = new WideInterval().day(1,2,3,4);
			assert.notOk(wi1.equals(wi2));
			assert.notOk(wi2.equals(wi1));
		});
		QUnit.test("Equals different 2", function(assert) {
			var wi1 = new WideInterval().week(1,2);
			var wi2 = new WideInterval().month(1,2);
			assert.notOk(wi1.equals(wi2));
			assert.notOk(wi2.equals(wi1));
		});
		QUnit.test("Equals different 3", function(assert) {
			var wi1 = new WideInterval().holiday("PH");
			var wi2 = new WideInterval().month(1,2);
			assert.notOk(wi1.equals(wi2));
			assert.notOk(wi2.equals(wi1));
		});
		QUnit.test("Equals same interval not same type", function(assert) {
			//Single day
			var wi1 = new WideInterval().day(28,11);
			assert.ok(wi1.equals(new WideInterval().day(28,11)));
			assert.notOk(wi1.equals(new WideInterval().day(28,11,3,12)));
			assert.notOk(wi1.equals(new WideInterval().week(1,15)));
			
			//Several days
			var wi2 = new WideInterval().day(28,11,3,12);
			assert.ok(wi2.equals(new WideInterval().day(28,11,3,12)));
			assert.notOk(wi2.equals(new WideInterval().day(28,11)));
			assert.notOk(wi2.equals(new WideInterval().week(1,15)));
			
			//Several days
			var wi3 = new WideInterval().day(1,11,31,12);
			assert.ok(wi3.equals(new WideInterval().day(1,11,31,12)));
			assert.ok(wi3.equals(new WideInterval().month(11,12)));
			assert.notOk(wi3.equals(new WideInterval().day(28,11)));
			assert.notOk(wi3.equals(new WideInterval().week(1,15)));
			
			//Single week
			var wi4 = new WideInterval().week(10);
			assert.ok(wi4.equals(new WideInterval().week(10,10)));
			assert.ok(wi4.equals(new WideInterval().week(10)));
			assert.notOk(wi4.equals(new WideInterval().day(28,11)));
			assert.notOk(wi4.equals(new WideInterval().week(1,15)));
			
			//Several weeks
			var wi5 = new WideInterval().week(10,15);
			assert.ok(wi5.equals(new WideInterval().week(10,15)));
			assert.notOk(wi5.equals(new WideInterval().day(28,11)));
			assert.notOk(wi5.equals(new WideInterval().week(10)));
			
			//Single month
			var wi7 = new WideInterval().month(11);
			assert.ok(wi7.equals(new WideInterval().month(11,11)));
			assert.ok(wi7.equals(new WideInterval().month(11)));
			assert.ok(wi7.equals(new WideInterval().day(1,11,30,11)));
			assert.notOk(wi7.equals(new WideInterval().day(28,11)));
			assert.notOk(wi7.equals(new WideInterval().week(1,15)));
			
			//Several months
			var wi8 = new WideInterval().month(11,12);
			assert.ok(wi8.equals(new WideInterval().month(11,12)));
			assert.ok(wi8.equals(new WideInterval().day(1,11,31,12)));
			assert.notOk(wi8.equals(new WideInterval().day(28,11)));
			assert.notOk(wi8.equals(new WideInterval().week(1,15)));
			assert.notOk(wi8.equals(new WideInterval().month(11)));
			assert.notOk(wi8.equals(new WideInterval().day(2,11,31,12)));
			assert.notOk(wi8.equals(new WideInterval().day(1,11,30,12)));
			
			//School holidays
			var wi10 = new WideInterval().holiday("SH");
			assert.ok(wi10.equals(new WideInterval().holiday("SH")));
			assert.notOk(wi10.equals(new WideInterval().holiday("PH")));
			assert.notOk(wi10.equals(new WideInterval().week(1,15)));
			assert.notOk(wi10.equals(new WideInterval().month(11)));
			
			//Public holidays
			var wi11 = new WideInterval().holiday("PH");
			assert.ok(wi11.equals(new WideInterval().holiday("PH")));
			assert.notOk(wi11.equals(new WideInterval().holiday("easter")));
			assert.notOk(wi11.equals(new WideInterval().week(1,15)));
			assert.notOk(wi11.equals(new WideInterval().month(11)));

			//All year
			var wi13 = new WideInterval().always();
			assert.ok(wi13.equals(new WideInterval().always()));
			assert.notOk(wi13.equals(new WideInterval().holiday("easter")));
			assert.notOk(wi13.equals(new WideInterval().week(1,15)));
			assert.notOk(wi13.equals(new WideInterval().month(11)));
		});
		QUnit.test("Get time for humans", function(assert) {
			//Single day
			var wi1 = new WideInterval().day(28, 11);
			assert.equal(wi1.getTimeForHumans(), "day November 28");
			
			//Several days
			var wi2 = new WideInterval().day(28, 11, 3, 12);
			assert.equal(wi2.getTimeForHumans(), "every week from November 28 to December 3");
			
			//Several days in a month
			var wi2 = new WideInterval().day(3, 11, 15, 11);
			assert.equal(wi2.getTimeForHumans(), "every week from November 3 to 15");
			
			//Single week
			var wi4 = new WideInterval().week(10);
			assert.equal(wi4.getTimeForHumans(), "week 10");
			
			//Several weeks
			var wi5 = new WideInterval().week(10,15);
			assert.equal(wi5.getTimeForHumans(), "every week from week 10 to 15");
			
			//Single month
			var wi7 = new WideInterval().month(11);
			assert.equal(wi7.getTimeForHumans(), "every week in November");
			
			//Several months
			var wi8 = new WideInterval().month(11,12);
			assert.equal(wi8.getTimeForHumans(), "every week from November to December");
			
			//School holidays
			var wi10 = new WideInterval().holiday("SH");
			assert.equal(wi10.getTimeForHumans(), "every week during school holidays");
			
			//Public holidays
			var wi11 = new WideInterval().holiday("PH");
			assert.equal(wi11.getTimeForHumans(), "every public holidays");
			
			//Easter
			var wi12 = new WideInterval().holiday("easter");
			assert.equal(wi12.getTimeForHumans(), "each easter day");
			
			//All year
			var wi13 = new WideInterval().always();
			assert.equal(wi13.getTimeForHumans(), "every week of year");
		});
		QUnit.test("Get time selector", function(assert) {
			//Single day
			var wi1 = new WideInterval().day(28, 11);
			assert.equal(wi1.getTimeSelector(), "Nov 28");
			
			//Several days
			var wi2 = new WideInterval().day(28, 11, 3, 12);
			assert.equal(wi2.getTimeSelector(), "Nov 28-Dec 03");
			
			//Single week
			var wi4 = new WideInterval().week(10);
			assert.equal(wi4.getTimeSelector(), "week 10");
			
			//Several weeks
			var wi5 = new WideInterval().week(5,15);
			assert.equal(wi5.getTimeSelector(), "week 05-15");
			
			//Single month
			var wi7 = new WideInterval().month(11);
			assert.equal(wi7.getTimeSelector(), "Nov");
			
			//Several months
			var wi8 = new WideInterval().month(11,12);
			assert.equal(wi8.getTimeSelector(), "Nov-Dec");
			
			//School holidays
			var wi10 = new WideInterval().holiday("SH");
			assert.equal(wi10.getTimeSelector(), "SH");
			
			//Public holidays
			var wi11 = new WideInterval().holiday("PH");
			assert.equal(wi11.getTimeSelector(), "PH");
			
			//Easter
			var wi12 = new WideInterval().holiday("easter");
			assert.equal(wi12.getTimeSelector(), "easter");
			
			//All year
			var wi13 = new WideInterval().always();
			assert.equal(wi13.getTimeSelector(), "");
		});
		QUnit.test("Is full month", function(assert){
			assert.ok(new WideInterval().month(10).isFullMonth());
			assert.ok(new WideInterval().month(10,10).isFullMonth());
			assert.notOk(new WideInterval().month(10,12).isFullMonth());
			
			assert.ok(new WideInterval().day(1,10,31,10).isFullMonth());
			assert.ok(new WideInterval().day(1,11,30,11).isFullMonth());
			assert.notOk(new WideInterval().day(1,10,30,10).isFullMonth());
			assert.notOk(new WideInterval().day(15,10,31,10).isFullMonth());
			assert.notOk(new WideInterval().month(1,10,31,12).isFullMonth());
			assert.notOk(new WideInterval().month(1,10).isFullMonth());
			
			assert.notOk(new WideInterval().week(8,10).isFullMonth());
		});
		QUnit.test("Starts month", function(assert) {
			assert.ok(new WideInterval().day(1,10).startsMonth());
			assert.ok(new WideInterval().day(1,10,15,12).startsMonth());
			assert.notOk(new WideInterval().day(3,10,15,12).startsMonth());
			assert.notOk(new WideInterval().day(3,10,15,10).startsMonth());
			assert.notOk(new WideInterval().day(3,10).startsMonth());
			
			assert.ok(new WideInterval().month(10).startsMonth());
			assert.ok(new WideInterval().month(10,12).startsMonth());
			
			assert.ok(new WideInterval().always().startsMonth());
			
			assert.notOk(new WideInterval().week(10).startsMonth());
			assert.notOk(new WideInterval().holiday("PH").startsMonth());
		});
		QUnit.test("Ends month", function(assert) {
			assert.ok(new WideInterval().day(15,10,31,12).endsMonth());
			assert.notOk(new WideInterval().day(1,10,30,12).endsMonth());
			assert.notOk(new WideInterval().day(3,10,29,10).endsMonth());
			assert.notOk(new WideInterval().day(18,10).endsMonth());
			assert.notOk(new WideInterval().day(30,10).endsMonth());
			
			assert.ok(new WideInterval().month(10).endsMonth());
			assert.ok(new WideInterval().month(10,12).endsMonth());
			
			assert.ok(new WideInterval().always().endsMonth());
			
			assert.notOk(new WideInterval().week(10).endsMonth());
			assert.notOk(new WideInterval().holiday("PH").endsMonth());
		});
		QUnit.test("Contains single day", function(assert) {
			var wi1 = new WideInterval().day(28, 11);
			assert.notOk(wi1.contains(new WideInterval().day(28, 11)));
			assert.notOk(wi1.contains(new WideInterval().day(28, 11, 29, 11)));
			assert.notOk(wi1.contains(new WideInterval().day(27, 11, 29, 11)));
			assert.notOk(wi1.contains(new WideInterval().week(10)));
			assert.notOk(wi1.contains(new WideInterval().month(11)));
			assert.notOk(wi1.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi1.contains(new WideInterval().always()));
		});
		QUnit.test("Contains several days", function(assert) {
			var wi2 = new WideInterval().day(28, 11, 3, 12);
			assert.notOk(wi2.contains(new WideInterval().day(28, 11, 3, 12)));
			assert.ok(wi2.contains(new WideInterval().day(29, 11, 3, 12)));
			assert.ok(wi2.contains(new WideInterval().day(29, 11, 2, 12)));
			assert.ok(wi2.contains(new WideInterval().day(29, 11, 30, 11)));
			assert.ok(wi2.contains(new WideInterval().day(29, 11)));
			assert.notOk(wi2.contains(new WideInterval().day(10, 11, 27, 11)));
			assert.notOk(wi2.contains(new WideInterval().day(4, 12, 25, 12)));
			assert.notOk(wi2.contains(new WideInterval().day(4, 11, 25, 12)));
			assert.notOk(wi2.contains(new WideInterval().week(10)));
			assert.notOk(wi2.contains(new WideInterval().month(11)));
			assert.notOk(wi2.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi2.contains(new WideInterval().always()));
		});
		QUnit.test("Contains single week", function(assert) {
			var wi4 = new WideInterval().week(10);
			assert.notOk(wi4.contains(new WideInterval().week(10)));
			assert.notOk(wi4.contains(new WideInterval().week(10, 15)));
			assert.notOk(wi4.contains(new WideInterval().day(10, 4)));
			assert.notOk(wi4.contains(new WideInterval().day(10, 4, 15, 5)));
			assert.notOk(wi4.contains(new WideInterval().month(11)));
			assert.notOk(wi4.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi4.contains(new WideInterval().always()));
		});
		QUnit.test("Contains several weeks", function(assert) {
			var wi5 = new WideInterval().week(5, 15);
			assert.notOk(wi5.contains(new WideInterval().week(5, 15)));
			assert.ok(wi5.contains(new WideInterval().week(5, 14)));
			assert.ok(wi5.contains(new WideInterval().week(6, 15)));
			assert.ok(wi5.contains(new WideInterval().week(6, 14)));
			assert.ok(wi5.contains(new WideInterval().week(6)));
			assert.ok(wi5.contains(new WideInterval().week(6, 6)));
			assert.notOk(wi5.contains(new WideInterval().day(10, 4)));
			assert.notOk(wi5.contains(new WideInterval().day(10, 4, 15, 5)));
			assert.notOk(wi5.contains(new WideInterval().month(11)));
			assert.notOk(wi5.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi5.contains(new WideInterval().always()));
		});
		QUnit.test("Contains single month", function(assert) {
			var wi7 = new WideInterval().month(11);
			assert.notOk(wi7.contains(new WideInterval().month(11)));
			assert.notOk(wi7.contains(new WideInterval().month(11, 11)));
			assert.notOk(wi7.contains(new WideInterval().month(10, 12)));
			assert.ok(wi7.contains(new WideInterval().day(2, 11, 8, 11)));
			assert.notOk(wi7.contains(new WideInterval().day(1, 11, 30, 11)));
			assert.notOk(wi7.contains(new WideInterval().day(5, 11, 15, 12)));
			assert.ok(wi7.contains(new WideInterval().day(5, 11)));
			assert.notOk(wi7.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi7.contains(new WideInterval().always()));
		});
		QUnit.test("Contains several months", function(assert) {
			var wi8 = new WideInterval().month(11, 12);
			assert.notOk(wi8.contains(new WideInterval().month(11, 12)));
			assert.ok(wi8.contains(new WideInterval().month(11)));
			assert.ok(wi8.contains(new WideInterval().month(11, 11)));
			assert.ok(wi8.contains(new WideInterval().day(2, 11, 30, 12)));
			assert.notOk(wi8.contains(new WideInterval().day(1, 11, 31, 12)));
			assert.ok(wi8.contains(new WideInterval().day(5, 11)));
			assert.ok(wi8.contains(new WideInterval().day(1, 11, 30, 12)));
			assert.ok(wi8.contains(new WideInterval().day(2, 11, 31, 12)));
			assert.notOk(wi8.contains(new WideInterval().week(10, 12)));
			assert.notOk(wi8.contains(new WideInterval().month(10, 12)));
			assert.notOk(wi8.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi8.contains(new WideInterval().always()));
		});
		QUnit.test("Contains school holidays", function(assert) {
			var wi10 = new WideInterval().holiday("SH");
			assert.notOk(wi10.contains(new WideInterval().holiday("SH")));
			assert.notOk(wi10.contains(new WideInterval().week(10, 12)));
			assert.notOk(wi10.contains(new WideInterval().month(10, 12)));
			assert.notOk(wi10.contains(new WideInterval().month(11, 1, 12, 30)));
			assert.notOk(wi10.contains(new WideInterval().month(11, 1)));
			assert.notOk(wi10.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi10.contains(new WideInterval().always()));
		});
		QUnit.test("Contains public holidays", function(assert) {
			var wi11 = new WideInterval().holiday("PH");
			assert.notOk(wi11.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi11.contains(new WideInterval().week(10, 12)));
			assert.notOk(wi11.contains(new WideInterval().month(10, 12)));
			assert.notOk(wi11.contains(new WideInterval().day(1, 11, 30, 12)));
			assert.notOk(wi11.contains(new WideInterval().day(1, 11)));
			assert.notOk(wi11.contains(new WideInterval().holiday("SH")));
			assert.notOk(wi11.contains(new WideInterval().always()));
		});
		QUnit.test("Contains easter", function(assert) {
			var wi12 = new WideInterval().holiday("easter");
			assert.notOk(wi12.contains(new WideInterval().holiday("easter")));
			assert.notOk(wi12.contains(new WideInterval().week(10, 12)));
			assert.notOk(wi12.contains(new WideInterval().month(10, 12)));
			assert.notOk(wi12.contains(new WideInterval().day(1, 11, 30, 12)));
			assert.notOk(wi12.contains(new WideInterval().day(1, 11)));
			assert.notOk(wi12.contains(new WideInterval().holiday("PH")));
			assert.notOk(wi12.contains(new WideInterval().holiday("SH")));
			assert.notOk(wi12.contains(new WideInterval().always()));
		});
		QUnit.test("Contains all year", function(assert) {
			var wi13 = new WideInterval().always();
			assert.notOk(wi13.contains(new WideInterval().always()));
			assert.ok(wi13.contains(new WideInterval().holiday("easter")));
			assert.ok(wi13.contains(new WideInterval().week(10, 12)));
			assert.ok(wi13.contains(new WideInterval().month(10, 12)));
			assert.ok(wi13.contains(new WideInterval().day(1, 11, 30, 12)));
			assert.ok(wi13.contains(new WideInterval().day(1, 11)));
			assert.ok(wi13.contains(new WideInterval().holiday("PH")));
			assert.ok(wi13.contains(new WideInterval().holiday("SH")));
		});
		
		/*
		 * Day
		 */
		QUnit.module("Model > Day");
		QUnit.test("Constructor", function(assert) {
			assert.ok(new Day());
		});
		QUnit.test("Minutes array", function(assert) {
			var day = new Day();
			day.addInterval(new Interval(0, 0, 60, 120));
			
			var minutes = day.getAsMinutesArray();
			assert.equal(minutes.length, 24*60+1);
			for(var m=0; m <= 24*60; m++) {
				if(m >= 60 && m <= 120) {
					assert.ok(minutes[m]);
				}
				else {
					assert.notOk(minutes[m]);
				}
			}
		});
		QUnit.test("Raw intervals", function(assert) {
			var day = new Day();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(0, 0, 360, 420);
			var it3 = new Interval(0, 0, 660, 720);
			
			var itId1 = day.addInterval(it1);
			var itId2 = day.addInterval(it2);
			var itId3 = day.addInterval(it3);
			
			//Check without deleting
			var intervals = day.getIntervals(false);
			assert.equal(intervals[itId1], it1);
			assert.equal(intervals[itId2], it2);
			assert.equal(intervals[itId3], it3);
			
			//Check with deleting
			day.removeInterval(itId2);
			var intervals2 = day.getIntervals(false);
			assert.equal(intervals[itId1], it1);
			assert.equal(intervals[itId2], undefined);
			assert.equal(intervals[itId3], it3);
		});
		QUnit.test("Cleaned intervals", function(assert) {
			var day = new Day();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(0, 0, 120, 300);
			var it3 = new Interval(0, 0, 660, 720);
			
			var itId1 = day.addInterval(it1);
			var itId2 = day.addInterval(it2);
			var itId3 = day.addInterval(it3);
			
			//Check without deleting
			var intervals = day.getIntervals(true);
			assert.equal(intervals.length, 2);
			var resIt1 = intervals[0];
			assert.equal(resIt1.getStartDay(), 0);
			assert.equal(resIt1.getEndDay(), 0);
			assert.equal(resIt1.getFrom(), 60);
			assert.equal(resIt1.getTo(), 300);
			
			var resIt2 = intervals[1];
			assert.equal(resIt2.getStartDay(), 0);
			assert.equal(resIt2.getEndDay(), 0);
			assert.equal(resIt2.getFrom(), 660);
			assert.equal(resIt2.getTo(), 720);
			
			//Check with deleting
			day.removeInterval(itId2);
			var intervals2 = day.getIntervals(true);
			assert.equal(intervals2.length, 2);
			var res2It1 = intervals2[0];
			assert.equal(res2It1.getStartDay(), 0);
			assert.equal(res2It1.getEndDay(), 0);
			assert.equal(res2It1.getFrom(), 60);
			assert.equal(res2It1.getTo(), 120);
			
			var res2It2 = intervals2[1];
			assert.equal(res2It2.getStartDay(), 0);
			assert.equal(res2It2.getEndDay(), 0);
			assert.equal(res2It2.getFrom(), 660);
			assert.equal(res2It2.getTo(), 720);
		});
		QUnit.test("Edit intervals", function(assert) {
			var day = new Day();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(0, 0, 360, 420);
			var it3 = new Interval(0, 0, 660, 720);
			var it4 = new Interval(0, 0, 664, 724);
			
			var itId1 = day.addInterval(it1);
			var itId2 = day.addInterval(it2);
			var itId3 = day.addInterval(it3);
			
			//Edit
			day.editInterval(itId2, it4);
			
			//Check
			var intervals = day.getIntervals(false);
			assert.equal(intervals[itId1], it1);
			assert.equal(intervals[itId2], it4);
			assert.equal(intervals[itId3], it3);
		});
		QUnit.test("Copy intervals", function(assert) {
			var day1 = new Day();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(0, 0, 360, 420);
			
			var itId1 = day1.addInterval(it1);
			var itId2 = day1.addInterval(it2);
			
			var day2 = new Day();
			day2.copyIntervals(day1.getIntervals(false));
			
			//Check
			var intervals = day2.getIntervals(false);
			var resIt1 = intervals[0];
			assert.equal(resIt1.getStartDay(), 0);
			assert.equal(resIt1.getEndDay(), 0);
			assert.equal(resIt1.getFrom(), 60);
			assert.equal(resIt1.getTo(), 120);
			
			var resIt2 = intervals[1];
			assert.equal(resIt2.getStartDay(), 0);
			assert.equal(resIt2.getEndDay(), 0);
			assert.equal(resIt2.getFrom(), 360);
			assert.equal(resIt2.getTo(), 420);
			
		});
		QUnit.test("Clear intervals", function(assert) {
			var day = new Day();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(0, 0, 360, 420);
			var it3 = new Interval(0, 0, 660, 720);
			
			var itId1 = day.addInterval(it1);
			var itId2 = day.addInterval(it2);
			var itId3 = day.addInterval(it3);
			
			//Check before
			var intervals = day.getIntervals(false);
			assert.equal(intervals.length, 3);
			
			day.clearIntervals();
			
			//Check after
			var intervals2 = day.getIntervals(false);
			assert.equal(intervals2.length, 0);
		});
		QUnit.test("Same as", function(assert) {
			var day1 = new Day();
			var day2 = new Day();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(0, 0, 360, 420);
			var it3 = new Interval(0, 0, 660, 720);
			
			day1.addInterval(it1);
			day1.addInterval(it2);
			day1.addInterval(it3);
			
			day2.addInterval(it1);
			day2.addInterval(it2);
			day2.addInterval(it3);
			
			//Same
			assert.ok(day1.sameAs(day2));
			
			day2.removeInterval(1);
			
			//Not same
			assert.notOk(day1.sameAs(day2));
		});

		/*
		 * Week
		 */
		QUnit.module("Model > Week");
		QUnit.test("Constructor", function(assert) {
			assert.ok(new Week());
		});
		QUnit.test("Minutes array", function(assert) {
			var week = new Week();
			week.addInterval(new Interval(0, 0, 60, 120));
			week.addInterval(new Interval(1, 2, 60, 120));
			
			var minutes = week.getAsMinutesArray();
			assert.equal(minutes.length, 7);
			for(var d=0; d < 7; d++) {
				assert.equal(minutes[d].length, 24*60+1);
				for(var m=0; m <= 24*60; m++) {
					if(d == 0) {
						if(m >= 60 && m <= 120) {
							assert.ok(minutes[d][m]);
						}
						else {
							assert.notOk(minutes[d][m]);
						}
					}
					else if(d==1) {
						if(m >= 60) {
							assert.ok(minutes[d][m]);
						}
						else {
							assert.notOk(minutes[d][m]);
						}
					}
					else if(d==2) {
						if(m <= 120) {
							assert.ok(minutes[d][m]);
						}
						else {
							assert.notOk(minutes[d][m]);
						}
					}
					else {
						assert.notOk(minutes[d][m]);
					}
				}
			}
		});
		QUnit.test("Raw intervals", function(assert) {
			var week = new Week();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(1, 2, 360, 420);
			var it3 = new Interval(5, 6, 660, 720);
			
			var itId1 = week.addInterval(it1);
			var itId2 = week.addInterval(it2);
			var itId3 = week.addInterval(it3);
			
			//Check without deleting
			var intervals = week.getIntervals(false);
			assert.equal(intervals[itId1], it1);
			assert.equal(intervals[itId2], it2);
			assert.equal(intervals[itId3], it3);
			
			//Check with deleting
			week.removeInterval(itId2);
			var intervals2 = week.getIntervals(false);
			assert.equal(intervals[itId1], it1);
			assert.equal(intervals[itId2], undefined);
			assert.equal(intervals[itId3], it3);
		});
		QUnit.test("Cleaned intervals simple", function(assert) {
			var week = new Week();
			
			var it1 = new Interval(0, 1, 60, 120);
			var it2 = new Interval(1, 2, 120, 300);
			var it3 = new Interval(0, 0, 660, 720);
			var it4 = new Interval(5, 5, 740, 830);
			
			var itId1 = week.addInterval(it1);
			var itId2 = week.addInterval(it2);
			var itId3 = week.addInterval(it3);
			var itId4 = week.addInterval(it4);
			
			//Check without deleting
			var intervals = week.getIntervals(true);
			assert.equal(intervals.length, 2);
			var resIt1 = intervals[0];
			assert.equal(resIt1.getStartDay(), 0);
			assert.equal(resIt1.getEndDay(), 2);
			assert.equal(resIt1.getFrom(), 60);
			assert.equal(resIt1.getTo(), 300);
			
			var resIt2 = intervals[1];
			assert.equal(resIt2.getStartDay(), 5);
			assert.equal(resIt2.getEndDay(), 5);
			assert.equal(resIt2.getFrom(), 740);
			assert.equal(resIt2.getTo(), 830);
			
			//Check with deleting
			week.removeInterval(itId2);
			var intervals2 = week.getIntervals(true);
			assert.equal(intervals2.length, 2);
			var res2It1 = intervals2[0];
			assert.equal(res2It1.getStartDay(), 0);
			assert.equal(res2It1.getEndDay(), 1);
			assert.equal(res2It1.getFrom(), 60);
			assert.equal(res2It1.getTo(), 120);
			
			var res2It2 = intervals2[1];
			assert.equal(res2It2.getStartDay(), 5);
			assert.equal(res2It2.getEndDay(), 5);
			assert.equal(res2It2.getFrom(), 740);
			assert.equal(res2It2.getTo(), 830);
		});
		QUnit.test("Cleaned intervals midnight", function(assert) {
			var week = new Week();
			
			var it1 = new Interval(0, 0, 60, 24*60);
			var it2 = new Interval(1, 1, 0, 300);
			var it3 = new Interval(2, 3, 300, 0);
			var it4 = new Interval(3, 3, 0, 450);
			
			var itId1 = week.addInterval(it1);
			var itId2 = week.addInterval(it2);
			var itId3 = week.addInterval(it3);
			var itId4 = week.addInterval(it4);
			
			//Check without deleting
			var intervals = week.getIntervals(true);
			assert.equal(intervals.length, 2);
			var resIt1 = intervals[0];
			assert.equal(resIt1.getStartDay(), 0);
			assert.equal(resIt1.getEndDay(), 1);
			assert.equal(resIt1.getFrom(), 60);
			assert.equal(resIt1.getTo(), 300);
			
			var resIt2 = intervals[1];
			assert.equal(resIt2.getStartDay(), 2);
			assert.equal(resIt2.getEndDay(), 3);
			assert.equal(resIt2.getFrom(), 300);
			assert.equal(resIt2.getTo(), 450);
		});
		QUnit.test("Edit intervals", function(assert) {
			var week = new Week();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(1, 1, 360, 420);
			var it3 = new Interval(2, 2, 660, 720);
			var it4 = new Interval(3, 3, 664, 724);
			
			var itId1 = week.addInterval(it1);
			var itId2 = week.addInterval(it2);
			var itId3 = week.addInterval(it3);
			
			//Edit
			week.editInterval(itId2, it4);
			
			//Check
			var intervals = week.getIntervals(false);
			assert.equal(intervals[itId1], it1);
			assert.equal(intervals[itId2], it4);
			assert.equal(intervals[itId3], it3);
		});
		QUnit.test("Copy intervals", function(assert) {
			var week1 = new Week();
			
			var it1 = new Interval(0, 1, 60, 120);
			var it2 = new Interval(3, 4, 360, 420);
			
			var itId1 = week1.addInterval(it1);
			var itId2 = week1.addInterval(it2);
			
			var week2 = new Week();
			week2.copyIntervals(week1.getIntervals(false));
			
			//Check
			var intervals = week2.getIntervals(false);
			var resIt1 = intervals[0];
			assert.equal(resIt1.getStartDay(), 0);
			assert.equal(resIt1.getEndDay(), 1);
			assert.equal(resIt1.getFrom(), 60);
			assert.equal(resIt1.getTo(), 120);
			
			var resIt2 = intervals[1];
			assert.equal(resIt2.getStartDay(), 3);
			assert.equal(resIt2.getEndDay(), 4);
			assert.equal(resIt2.getFrom(), 360);
			assert.equal(resIt2.getTo(), 420);
		});
		QUnit.test("Remove intervals during day", function(assert) {
			var week = new Week();
			
			var it1 = new Interval(0, 0, 60, 120);
			var it2 = new Interval(2, 4, 360, 420);
			
			var itId1 = week.addInterval(it1);
			var itId2 = week.addInterval(it2);
			
			//Check before
			var intervals = week.getIntervals(false);
			assert.equal(intervals.length, 2);
			
			week.removeIntervalsDuringDay(3);
			
			//Check after
			var intervals2 = week.getIntervals(false);
			assert.equal(intervals2.length, 4);
			assert.equal(intervals2[itId1], it1);
			
			var resIt2p1 = intervals2[2];
			assert.equal(resIt2p1.getStartDay(), 2);
			assert.equal(resIt2p1.getEndDay(), 2);
			assert.equal(resIt2p1.getFrom(), 360);
			assert.equal(resIt2p1.getTo(), 24*60);
			
			var resIt2p2 = intervals2[3];
			assert.equal(resIt2p2.getStartDay(), 4);
			assert.equal(resIt2p2.getEndDay(), 4);
			assert.equal(resIt2p2.getFrom(), 0);
			assert.equal(resIt2p2.getTo(), 420);
		});
		QUnit.test("Remove intervals during day 2", function(assert) {
			var week = new Week();
			
			var it1 = new Interval(0, 0, 8*60, 18*60);
			var it2 = new Interval(1, 1, 8*60, 18*60);
			var it3 = new Interval(2, 2, 8*60, 18*60);
			var it4 = new Interval(3, 3, 8*60, 18*60);
			var it5 = new Interval(4, 4, 8*60, 18*60);
			var it6 = new Interval(5, 5, 8*60, 18*60);
			var it7 = new Interval(6, 6, 8*60, 18*60);
			
			var itId1 = week.addInterval(it1);
			var itId2 = week.addInterval(it2);
			var itId3 = week.addInterval(it3);
			var itId4 = week.addInterval(it4);
			var itId5 = week.addInterval(it5);
			var itId6 = week.addInterval(it6);
			var itId7 = week.addInterval(it7);
			
			//Check before
			var intervals = week.getIntervals(false);
			assert.equal(intervals.length, 7);
			
			week.removeIntervalsDuringDay(1);
			
			//Check after
			var intervals2 = week.getIntervals(false);
			assert.equal(intervals2.length, 7);
			assert.equal(intervals2[itId1], it1);
			assert.equal(intervals2[itId2], undefined);
			assert.equal(intervals2[itId3], it3);
			assert.equal(intervals2[itId4], it4);
			assert.equal(intervals2[itId5], it5);
			assert.equal(intervals2[itId6], it6);
			assert.equal(intervals2[itId7], it7);
		});
		QUnit.test("Remove intervals during day 3 (over night)", function(assert) {
			var week = new Week();
			
			var it1 = new Interval(0, 1, 23*60, 3*60);
			var it2 = new Interval(1, 2, 23*60, 3*60);
			var it3 = new Interval(2, 3, 23*60, 3*60);
			
			var itId1 = week.addInterval(it1);
			var itId2 = week.addInterval(it2);
			var itId3 = week.addInterval(it3);

			//Check before
			var intervals = week.getIntervals(false);
			assert.equal(intervals.length, 3);
			
			week.removeIntervalsDuringDay(1);
			
			//Check after
			var intervals2 = week.getIntervals(false);
			assert.equal(intervals2.length, 3);
			assert.equal(intervals2[itId1], it1);
			assert.equal(intervals2[itId2], undefined);
			assert.equal(intervals2[itId3], it3);
		});
		QUnit.test("Same as", function(assert) {
			var week1 = new Week();
			var week2 = new Week();
			
			var it1 = new Interval(0, 1, 60, 120);
			var it2 = new Interval(3, 3, 360, 420);
			var it3 = new Interval(4, 6, 660, 720);
			
			week1.addInterval(it1);
			week1.addInterval(it2);
			week1.addInterval(it3);
			
			week2.addInterval(it1);
			week2.addInterval(it2);
			week2.addInterval(it3);
			
			//Same
			assert.ok(week1.sameAs(week2));
			
			week2.removeInterval(1);
			
			//Not same
			assert.notOk(week1.sameAs(week2));
		});
		QUnit.test("Get intervals diff simple", function(assert) {
			var week1 = new Week();
			var week2 = new Week();
			
			var it1 = new Interval(0,6,0,24*60);
			week1.addInterval(it1);
			
			var it2 = new Interval(0,3,0,24*60);
			var it3 = new Interval(5,6,0,24*60);
			var it4 = new Interval(4,4,8*60,18*60);
			week2.addInterval(it2);
			week2.addInterval(it3);
			week2.addInterval(it4);
			
			var result = week2.getIntervalsDiff(week1);
			assert.equal(result.open.length, 1);
			assert.equal(result.closed.length, 0);
			
			var resIt1 = result.open[0];
			assert.equal(resIt1.getStartDay(), 4);
			assert.equal(resIt1.getEndDay(), 4);
			assert.equal(resIt1.getFrom(), 8*60);
			assert.equal(resIt1.getTo(), 18*60);
		});
		QUnit.test("Get intervals diff day off", function(assert) {
			var week1 = new Week();
			var week2 = new Week();
			
			var it1 = new Interval(0,6,0,24*60);
			week1.addInterval(it1);
			
			var it2 = new Interval(0,3,0,24*60);
			var it3 = new Interval(5,6,0,24*60);
			week2.addInterval(it2);
			week2.addInterval(it3);
			
			var result = week2.getIntervalsDiff(week1);
			assert.equal(result.open.length, 0);
			assert.equal(result.closed.length, 1);
			
			var resIt1 = result.closed[0];
			assert.equal(resIt1.getStartDay(), 4);
			assert.equal(resIt1.getEndDay(), 4);
			assert.equal(resIt1.getFrom(), 0);
			assert.equal(resIt1.getTo(), 24*60);
		});
		QUnit.test("Get intervals diff quasi closed", function(assert) {
			var week1 = new Week();
			var week2 = new Week();
			
			var it1 = new Interval(0,6,0,24*60);
			week1.addInterval(it1);
			
			var it2 = new Interval(3,3,18*60,23*60);
			week2.addInterval(it2);
			
			var result = week2.getIntervalsDiff(week1);
			assert.equal(result.open.length, 1);
			assert.equal(result.closed.length, 2);
			
			var resIt1 = result.open[0];
			assert.equal(resIt1.getStartDay(), 3);
			assert.equal(resIt1.getEndDay(), 3);
			assert.equal(resIt1.getFrom(), 18*60);
			assert.equal(resIt1.getTo(), 23*60);
			
			var resIt2 = result.closed[0];
			assert.equal(resIt2.getStartDay(), 0);
			assert.equal(resIt2.getEndDay(), 2);
			assert.equal(resIt2.getFrom(), 0);
			assert.equal(resIt2.getTo(), 24*60);
			
			var resIt3 = result.closed[1];
			assert.equal(resIt3.getStartDay(), 4);
			assert.equal(resIt3.getEndDay(), 6);
			assert.equal(resIt3.getFrom(), 0);
			assert.equal(resIt3.getTo(), 24*60);
		});
		QUnit.test("Get intervals diff many changes", function(assert) {
			var week1 = new Week();
			var week2 = new Week();
			
			var it1 = new Interval(0,0,10*60,12*60);
			var it2 = new Interval(0,0,13*60,16*60);
			var it3 = new Interval(1,1,10*60,12*60);
			var it4 = new Interval(1,1,13*60,16*60);
			var it5 = new Interval(2,2,10*60,12*60);
			var it6 = new Interval(2,2,13*60,16*60);
			var it7 = new Interval(3,3,10*60,12*60);
			var it8 = new Interval(3,3,13*60,16*60);
			var it9 = new Interval(4,4,8*60,12*60);
			var it10 = new Interval(4,4,13*60,18*60);
			week1.addInterval(it1);
			week1.addInterval(it2);
			week1.addInterval(it3);
			week1.addInterval(it4);
			week1.addInterval(it5);
			week1.addInterval(it6);
			week1.addInterval(it7);
			week1.addInterval(it8);
			week1.addInterval(it9);
			week1.addInterval(it10);
			
			var it11 = new Interval(0,0,10*60,16*60);
			var it12 = new Interval(1,1,10*60,12*60);
			var it13 = new Interval(1,1,13*60,16*60);
			var it14 = new Interval(3,3,8*60,10*60);
			var it15 = new Interval(3,3,12*60,13*60);
			var it16 = new Interval(4,4,10*60,16*60);
			var it18 = new Interval(5,5,10*60,12*60);
			var it19 = new Interval(5,5,13*60,16*60);
			week2.addInterval(it11);
			week2.addInterval(it12);
			week2.addInterval(it13);
			week2.addInterval(it14);
			week2.addInterval(it15);
			week2.addInterval(it16);
			week2.addInterval(it18);
			week2.addInterval(it19);
			
			var result = week2.getIntervalsDiff(week1);
			assert.equal(result.open.length, 6);
			assert.equal(result.closed.length, 1);
			
			var resIt1 = result.open[0];
			assert.equal(resIt1.getStartDay(), 0);
			assert.equal(resIt1.getEndDay(), 0);
			assert.equal(resIt1.getFrom(), 10*60);
			assert.equal(resIt1.getTo(), 16*60);
			
			var resIt2 = result.closed[0];
			assert.equal(resIt2.getStartDay(), 2);
			assert.equal(resIt2.getEndDay(), 2);
			assert.equal(resIt2.getFrom(), 0);
			assert.equal(resIt2.getTo(), 24*60);
			
			var resIt3 = result.open[1];
			assert.equal(resIt3.getStartDay(), 3);
			assert.equal(resIt3.getEndDay(), 3);
			assert.equal(resIt3.getFrom(), 8*60);
			assert.equal(resIt3.getTo(), 10*60);
			
			var resIt4 = result.open[2];
			assert.equal(resIt4.getStartDay(), 3);
			assert.equal(resIt4.getEndDay(), 3);
			assert.equal(resIt4.getFrom(), 12*60);
			assert.equal(resIt4.getTo(), 13*60);
			
			var resIt5 = result.open[3];
			assert.equal(resIt5.getStartDay(), 4);
			assert.equal(resIt5.getEndDay(), 4);
			assert.equal(resIt5.getFrom(), 10*60);
			assert.equal(resIt5.getTo(), 16*60);
			
			var resIt6 = result.open[4];
			assert.equal(resIt6.getStartDay(), 5);
			assert.equal(resIt6.getEndDay(), 5);
			assert.equal(resIt6.getFrom(), 10*60);
			assert.equal(resIt6.getTo(), 12*60);
			
			var resIt7 = result.open[5];
			assert.equal(resIt7.getStartDay(), 5);
			assert.equal(resIt7.getEndDay(), 5);
			assert.equal(resIt7.getFrom(), 13*60);
			assert.equal(resIt7.getTo(), 16*60);
		});
		QUnit.test("Get intervals diff 24/24", function(assert) {
			var week1 = new Week();
			var week2 = new Week();
			
			var it1 = new Interval(0,4,0,24*60);
			week1.addInterval(it1);
			
			var it2 = new Interval(0,5,0,24*60);
			week2.addInterval(it2);
			
			var result = week2.getIntervalsDiff(week1);
			assert.equal(result.open.length, 1);
			assert.equal(result.closed.length, 0);
			
			var resIt1 = result.open[0];
			assert.equal(resIt1.getStartDay(), 5);
			assert.equal(resIt1.getEndDay(), 5);
			assert.equal(resIt1.getFrom(), 0);
			assert.equal(resIt1.getTo(), 24*60);
		});
		
		/*
		 * DateRange
		 */
		QUnit.module("Model > DateRange");
		QUnit.test("Constructor", function(assert) {
			assert.ok(new DateRange(new WideInterval().always()));
			assert.ok(new DateRange(new WideInterval().week(15,16)));
		});
		QUnit.test("Defines typical day/week", function(assert) {
			//Single day
			var dr1 = new DateRange(new WideInterval().day(28,11));
			assert.ok(dr1.definesTypicalDay());
			assert.notOk(dr1.definesTypicalWeek());
			
			//Several days
			var dr2 = new DateRange(new WideInterval().day(28,11,3,12));
			assert.notOk(dr2.definesTypicalDay());
			assert.ok(dr2.definesTypicalWeek());
			
			//Same day as start and end
			var dr3 = new DateRange(new WideInterval().day(28,11,28,11));
			assert.ok(dr3.definesTypicalDay());
			assert.notOk(dr3.definesTypicalWeek());
			
			//Single week
			var dr4 = new DateRange(new WideInterval().week(10));
			assert.notOk(dr4.definesTypicalDay());
			assert.ok(dr4.definesTypicalWeek());
			
			//Several weeks
			var dr5 = new DateRange(new WideInterval().week(10,15));
			assert.notOk(dr5.definesTypicalDay());
			assert.ok(dr5.definesTypicalWeek());
			
			//Same week as start and end
			var dr6 = new DateRange(new WideInterval().week(10,10));
			assert.notOk(dr6.definesTypicalDay());
			assert.ok(dr6.definesTypicalWeek());
			
			//Single month
			var dr7 = new DateRange(new WideInterval().month(11));
			assert.notOk(dr7.definesTypicalDay());
			assert.ok(dr7.definesTypicalWeek());
			
			//Several months
			var dr8 = new DateRange(new WideInterval().month(11,12));
			assert.notOk(dr8.definesTypicalDay());
			assert.ok(dr8.definesTypicalWeek());
			
			//Same month as start and end
			var dr9 = new DateRange(new WideInterval().month(11,11));
			assert.notOk(dr9.definesTypicalDay());
			assert.ok(dr9.definesTypicalWeek());
			
			//School holidays
			var dr10 = new DateRange(new WideInterval().holiday("SH"));
			assert.notOk(dr10.definesTypicalDay());
			assert.ok(dr10.definesTypicalWeek());
			
			//Public holidays
			var dr11 = new DateRange(new WideInterval().holiday("PH"));
			assert.ok(dr11.definesTypicalDay());
			assert.notOk(dr11.definesTypicalWeek());
			
			//Easter
			var dr12 = new DateRange(new WideInterval().holiday("easter"));
			assert.ok(dr12.definesTypicalDay());
			assert.notOk(dr12.definesTypicalWeek());
			
			//All year
			var dr13 = new DateRange(new WideInterval().always());
			assert.notOk(dr13.definesTypicalDay());
			assert.ok(dr13.definesTypicalWeek());
		});
		QUnit.test("Get typical day/week", function(assert) {
			//Typical day
			var dr1 = new DateRange(new WideInterval().day(28,11));
			var t1 = dr1.getTypical();
			assert.ok(t1 instanceof Day);
			
			//Typical week
			var dr2 = new DateRange(new WideInterval().holiday("SH"));
			var t2 = dr2.getTypical();
			assert.ok(t2 instanceof Week);
		});
		QUnit.test("Get interval", function(assert) {
			var wi1 = new WideInterval().day(28,11);
			var dr1 = new DateRange(wi1);
			assert.equal(dr1.getInterval(), wi1);
		});
		QUnit.test("Update range", function(assert) {
			var dr1 = new DateRange(new WideInterval().day(28,11));
			
			//Check before
			var st1 = dr1.getInterval().getStart();
			assert.equal(st1.day, 28);
			assert.equal(st1.month, 11);
			var end1 = dr1.getInterval().getEnd();
			assert.equal(end1, null);
			
			dr1.updateRange(new WideInterval().week(5,10));
			
			//Check after
			var resSt1 = dr1.getInterval().getStart();
			assert.equal(resSt1.week, 5);
			assert.equal(resSt1.day, undefined);
			assert.equal(resSt1.month, undefined);
			var resEnd1 = dr1.getInterval().getEnd();
			assert.equal(resEnd1.week, 10);
		});
		QUnit.test("Is general for", function(assert) {
			//Single day
			var dr1 = new DateRange(new WideInterval().day(28,11));
			assert.notOk(dr1.isGeneralFor(new DateRange(new WideInterval().day(28,11))));
			assert.notOk(dr1.isGeneralFor(new DateRange(new WideInterval().day(28,11,29,11))));
			assert.notOk(dr1.isGeneralFor(new DateRange(new WideInterval().day(27,11,29,11))));
			assert.notOk(dr1.isGeneralFor(new DateRange(new WideInterval().week(10))));
			assert.notOk(dr1.isGeneralFor(new DateRange(new WideInterval().month(11))));
			assert.notOk(dr1.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr1.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//Several days
			var dr2 = new DateRange(new WideInterval().day(28,11,3,12));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().day(28,11,3,12))));
			assert.ok(dr2.isGeneralFor(new DateRange(new WideInterval().day(29,11,3,12))));
			assert.ok(dr2.isGeneralFor(new DateRange(new WideInterval().day(29,11,2,12))));
			assert.ok(dr2.isGeneralFor(new DateRange(new WideInterval().day(29,11,30,11))));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().day(29,11))));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().day(10,11,27,11))));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().day(4,12,25,12))));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().day(4,11,25,12))));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().week(10))));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().month(11))));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr2.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//Single week
			var dr4 = new DateRange(new WideInterval().week(10));
			assert.notOk(dr4.isGeneralFor(new DateRange(new WideInterval().week(10))));
			assert.notOk(dr4.isGeneralFor(new DateRange(new WideInterval().week(10,15))));
			assert.notOk(dr4.isGeneralFor(new DateRange(new WideInterval().day(4,10))));
			assert.notOk(dr4.isGeneralFor(new DateRange(new WideInterval().day(4,10,15,5))));
			assert.notOk(dr4.isGeneralFor(new DateRange(new WideInterval().month(11))));
			assert.notOk(dr4.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr4.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//Several weeks
			var dr5 = new DateRange(new WideInterval().week(5,15));
			assert.notOk(dr5.isGeneralFor(new DateRange(new WideInterval().week(5,15))));
			assert.ok(dr5.isGeneralFor(new DateRange(new WideInterval().week(5,14))));
			assert.ok(dr5.isGeneralFor(new DateRange(new WideInterval().week(6,15))));
			assert.ok(dr5.isGeneralFor(new DateRange(new WideInterval().week(6,14))));
			assert.ok(dr5.isGeneralFor(new DateRange(new WideInterval().week(6))));
			assert.ok(dr5.isGeneralFor(new DateRange(new WideInterval().week(6,6))));
			assert.notOk(dr5.isGeneralFor(new DateRange(new WideInterval().day(4,10))));
			assert.notOk(dr5.isGeneralFor(new DateRange(new WideInterval().day(4,10,15,5))));
			assert.notOk(dr5.isGeneralFor(new DateRange(new WideInterval().month(11))));
			assert.notOk(dr5.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr5.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//Single month
			var dr7 = new DateRange(new WideInterval().month(11));
			assert.notOk(dr7.isGeneralFor(new DateRange(new WideInterval().month(11))));
			assert.notOk(dr7.isGeneralFor(new DateRange(new WideInterval().month(11,11))));
			assert.notOk(dr7.isGeneralFor(new DateRange(new WideInterval().month(10,12))));
			assert.ok(dr7.isGeneralFor(new DateRange(new WideInterval().day(2,11,8,11))));
			assert.notOk(dr7.isGeneralFor(new DateRange(new WideInterval().day(1,11,30,11))));
			assert.notOk(dr7.isGeneralFor(new DateRange(new WideInterval().day(5,11,15,12))));
			assert.notOk(dr7.isGeneralFor(new DateRange(new WideInterval().day(5,11))));
			assert.notOk(dr7.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr7.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//Several months
			var dr8 = new DateRange(new WideInterval().month(11,12));
			assert.notOk(dr8.isGeneralFor(new DateRange(new WideInterval().month(11,12))));
			assert.ok(dr8.isGeneralFor(new DateRange(new WideInterval().month(11))));
			assert.ok(dr8.isGeneralFor(new DateRange(new WideInterval().month(11,11))));
			assert.ok(dr8.isGeneralFor(new DateRange(new WideInterval().day(2,11,30,12))));
			assert.notOk(dr8.isGeneralFor(new DateRange(new WideInterval().day(1,11,31,12))));
			assert.notOk(dr8.isGeneralFor(new DateRange(new WideInterval().day(5,11))));
			assert.ok(dr8.isGeneralFor(new DateRange(new WideInterval().day(1,11,30,12))));
			assert.ok(dr8.isGeneralFor(new DateRange(new WideInterval().day(2,11,31,12))));
			assert.notOk(dr8.isGeneralFor(new DateRange(new WideInterval().week(10,12))));
			assert.notOk(dr8.isGeneralFor(new DateRange(new WideInterval().month(10,12))));
			assert.notOk(dr8.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr8.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//School holidays
			var dr10 = new DateRange(new WideInterval().holiday("SH"));
			assert.notOk(dr10.isGeneralFor(new DateRange(new WideInterval().holiday("SH"))));
			assert.notOk(dr10.isGeneralFor(new DateRange(new WideInterval().week(10,12))));
			assert.notOk(dr10.isGeneralFor(new DateRange(new WideInterval().month(10,12))));
			assert.notOk(dr10.isGeneralFor(new DateRange(new WideInterval().day(1,11,30,12))));
			assert.notOk(dr10.isGeneralFor(new DateRange(new WideInterval().day(1,11))));
			assert.notOk(dr10.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr10.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//Public holidays
			var dr11 = new DateRange(new WideInterval().holiday("PH"));
			assert.notOk(dr11.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr11.isGeneralFor(new DateRange(new WideInterval().week(10,12))));
			assert.notOk(dr11.isGeneralFor(new DateRange(new WideInterval().month(10,12))));
			assert.notOk(dr11.isGeneralFor(new DateRange(new WideInterval().day(1,11,30,12))));
			assert.notOk(dr11.isGeneralFor(new DateRange(new WideInterval().day(1,11))));
			assert.notOk(dr11.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr11.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//Easter
			var dr12 = new DateRange(new WideInterval().holiday("easter"));
			assert.notOk(dr12.isGeneralFor(new DateRange(new WideInterval().holiday("easter"))));
			assert.notOk(dr12.isGeneralFor(new DateRange(new WideInterval().week(10,12))));
			assert.notOk(dr12.isGeneralFor(new DateRange(new WideInterval().month(10,12))));
			assert.notOk(dr12.isGeneralFor(new DateRange(new WideInterval().day(1,11,30,12))));
			assert.notOk(dr12.isGeneralFor(new DateRange(new WideInterval().day(1,11))));
			assert.notOk(dr12.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.notOk(dr12.isGeneralFor(new DateRange(new WideInterval().holiday("SH"))));
			assert.notOk(dr12.isGeneralFor(new DateRange(new WideInterval().always())));
			
			//All year
			var dr13 = new DateRange(new WideInterval().always());
			assert.notOk(dr13.isGeneralFor(new DateRange(new WideInterval().always())));
			assert.notOk(dr13.isGeneralFor(new DateRange(new WideInterval().holiday("easter"))));
			assert.ok(dr13.isGeneralFor(new DateRange(new WideInterval().week(10,12))));
			assert.ok(dr13.isGeneralFor(new DateRange(new WideInterval().month(10,12))));
			assert.ok(dr13.isGeneralFor(new DateRange(new WideInterval().day(1,11,30,12))));
			assert.notOk(dr13.isGeneralFor(new DateRange(new WideInterval().day(1,11))));
			assert.notOk(dr13.isGeneralFor(new DateRange(new WideInterval().holiday("PH"))));
			assert.ok(dr13.isGeneralFor(new DateRange(new WideInterval().holiday("SH"))));
		});
		QUnit.test("Has same typical", function(assert) {
			var dr1 = new DateRange(new WideInterval().always());
			var dr2 = new DateRange(new WideInterval().month(3));
			var dr3 = new DateRange(new WideInterval().month(5));
			
			dr1.getTypical().addInterval(new Interval(0, 1, 42, 60));
			dr2.getTypical().addInterval(new Interval(0, 1, 42, 60));
			dr3.getTypical().addInterval(new Interval(0, 2, 42, 60));
			
			assert.ok(dr1.hasSameTypical(dr2));
			assert.notOk(dr1.hasSameTypical(dr3));
		});
		
		/*
		 * OhTime
		 */
		QUnit.module("Model > OhTime");
		QUnit.test("Constructor", function(assert) {
			var oh = new OhTime(0, 60);
			var oh2 = new OhTime(0);
			assert.expect(0);
		});
		QUnit.test("Get void", function(assert) {
			var oh = new OhTime();
			assert.equal(oh.get(), "off");
		});
		QUnit.test("Get without end", function(assert) {
			var oh = new OhTime(0);
			assert.equal(oh.get(), "00:00");
		});
		QUnit.test("Get start = end", function(assert) {
			var oh = new OhTime(10,10);
			assert.equal(oh.get(), "00:10");
		});
		QUnit.test("Get with end", function(assert) {
			var oh = new OhTime(0, 60);
			assert.equal(oh.get(), "00:00-01:00");
		});
		QUnit.test("Get start", function(assert) {
			var oh = new OhTime(10, 60);
			assert.equal(oh.getStart(), 10);
		});
		QUnit.test("Get end null", function(assert) {
			var oh = new OhTime(10);
			assert.equal(oh.getEnd(), null);
		});
		QUnit.test("Get end not null", function(assert) {
			var oh = new OhTime(10, 60);
			assert.equal(oh.getEnd(), 60);
		});
		QUnit.test("Equals same", function(assert) {
			var oh = new OhTime(10, 60);
			var oh2 = new OhTime(10, 60);
			assert.ok(oh.equals(oh2));
			assert.ok(oh2.equals(oh));
		});
		QUnit.test("Equals different", function(assert) {
			var oh = new OhTime(10, 60);
			var oh2 = new OhTime(42, 60);
			assert.notOk(oh.equals(oh2));
			assert.notOk(oh2.equals(oh));
		});
		
		/*
		 * OhDate
		 */
		QUnit.module("Model > OhDate");
		QUnit.test("Constructor missing parameter", function(assert) {
			try {
				var od = new OhDate();
				assert.ok(false);
			}
			catch(e) {
				assert.ok(true);
			}
		});
		QUnit.test("Constructor valid parameter", function(assert) {
			assert.ok(new OhDate("Apr 21-Aug 22", "day", [0,1,3,5,6]));
		});
		QUnit.test("Get wide type", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,3,5,6]);
			assert.equal(od.getWideType(), "day");
		});
		QUnit.test("Get wide value", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,3,5,6]);
			assert.equal(od.getWideValue(), "Apr 21-Aug 22");
		});
		QUnit.test("Get wd sorted", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,3,5,6]);
			assert.equal(od.getWd()[0], 0);
			assert.equal(od.getWd()[1], 1);
			assert.equal(od.getWd()[2], 3);
			assert.equal(od.getWd()[3], 5);
			assert.equal(od.getWd()[4], 6);
		});
		QUnit.test("Get wd unsorted", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [5,3,0,6,1]);
			assert.equal(od.getWd()[0], 0);
			assert.equal(od.getWd()[1], 1);
			assert.equal(od.getWd()[2], 3);
			assert.equal(od.getWd()[3], 5);
			assert.equal(od.getWd()[4], 6);
		});
		QUnit.test("Same wd sorted", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,3,5,6]);
			assert.ok(od.sameWd([0,1,3,5,6]));
			assert.notOk(od.sameWd([0,2,5]));
		});
		QUnit.test("Same wd unsorted", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [5,3,0,6,1]);
			assert.ok(od.sameWd([0,1,3,5,6]));
			assert.notOk(od.sameWd([0,2,5]));
		});
		QUnit.test("Get weekdays 1", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,3,5]);
			assert.equal(od.getWeekdays(), "Mo,Tu,Th,Sa");
		});
		QUnit.test("Get weekdays 2", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,4,3,2,5]);
			assert.equal(od.getWeekdays(), "Mo-Sa");
		});
		QUnit.test("Get weekdays 3", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,6]);
			assert.equal(od.getWeekdays(), "Mo,Su");
		});
		QUnit.test("Get weekdays 4-1", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [6,0,1]);
			assert.equal(od.getWeekdays(), "Su-Tu");
		});
		QUnit.test("Get weekdays 4-2", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [5,6,0,1,3]);
			assert.equal(od.getWeekdays(), "Sa-Tu,Th");
		});
		QUnit.test("Get weekdays 4-3", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,3,6]);
			assert.equal(od.getWeekdays(), "Mo,Th,Su");
		});
		QUnit.test("Get weekdays 4-3", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,2,3,4,5,6]);
			assert.equal(od.getWeekdays(), "");
		});
		QUnit.test("Get weekdays 4-3", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [-2,0,1,5,6]);
			assert.equal(od.getWeekdays(), "PH,Sa-Tu");
		});
		QUnit.test("Get weekdays 5", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,2,4,5,6]);
			assert.equal(od.getWeekdays(), "Fr-We");
		});
		QUnit.test("Get weekdays 6", function(assert) {
			var od = new OhDate("Apr 21-Aug 22", "day", [0,1,2,3,4,5,6]);
			assert.equal(od.getWeekdays(), "");
		});
		QUnit.test("Same kind as valid", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,1,2,4,5,6]);
			var od2 = new OhDate("Mar 01-Apr 02", "day", [0,1,2,4,5,6]);
			assert.ok(od1.sameKindAs(od2));
			assert.ok(od2.sameKindAs(od1));
		});
		QUnit.test("Same kind as invalid", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,1,2,4,5,6]);
			var od2 = new OhDate("SH", "holiday", [0,1,2,4,5,6]);
			var od3 = new OhDate("Mar 01-Mar 15", "day", [4,5,6]);
			assert.notOk(od1.sameKindAs(od2));
			assert.notOk(od2.sameKindAs(od1));
			assert.notOk(od1.sameKindAs(od3));
			assert.notOk(od3.sameKindAs(od1));
		});
		QUnit.test("Equals same", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,1,2,4,5,6]);
			var od2 = new OhDate("Apr 21-Aug 22", "day", [0,1,2,4,5,6]);
			assert.ok(od1.equals(od1));
			assert.ok(od1.equals(od2));
			assert.ok(od2.equals(od1));
			assert.ok(od2.equals(od2));
		});
		QUnit.test("Equals different", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,1,2,4,5,6]);
			var od2 = new OhDate("", "always", [0,1,4,5,6]);
			assert.ok(od1.equals(od1));
			assert.notOk(od1.equals(od2));
			assert.notOk(od2.equals(od1));
			assert.ok(od2.equals(od2));
		});
		QUnit.test("Add weekday new", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0]);
			assert.equal(od1.getWd().length, 1);
			
			od1.addWeekday(5);
			assert.equal(od1.getWd().length, 2);
			assert.equal(od1.getWd()[0], 0);
			assert.equal(od1.getWd()[1], 5);
		});
		QUnit.test("Add weekday existing", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0, 3]);
			assert.equal(od1.getWd().length, 2);
			
			od1.addWeekday(3);
			assert.equal(od1.getWd().length, 2);
			assert.equal(od1.getWd()[0], 0);
			assert.equal(od1.getWd()[1], 3);
		});
		QUnit.test("Add overwritten weekday new", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0]);
			assert.equal(od1.getWeekdays(), "Mo");
			od1.addOverwrittenWeekday(2);
			assert.equal(od1.getWeekdays(), "Mo,We");
		});
		QUnit.test("Add overwritten weekday existing wd", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,2]);
			assert.equal(od1.getWeekdays(), "Mo,We");
			od1.addOverwrittenWeekday(2);
			assert.equal(od1.getWeekdays(), "Mo,We");
		});
		QUnit.test("Add overwritten weekday existing over wd", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,2]);
			assert.equal(od1.getWeekdays(), "Mo,We");
			od1.addOverwrittenWeekday(4);
			assert.equal(od1.getWeekdays(), "Mo,We,Fr");
			od1.addOverwrittenWeekday(4);
			assert.equal(od1.getWeekdays(), "Mo,We,Fr");
		});
		QUnit.test("Add PH weekday new", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0]);
			assert.equal(od1.getWeekdays(), "Mo");
			od1.addPhWeekday();
			assert.equal(od1.getWeekdays(), "PH,Mo");
		});
		QUnit.test("Add PH weekday existing wd", function(assert) {
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,2]);
			od1.addPhWeekday();
			assert.equal(od1.getWeekdays(), "PH,Mo,We");
			od1.addPhWeekday();
			assert.equal(od1.getWeekdays(), "PH,Mo,We");
		});
		
		/*
		 * OhRule
		 */
		QUnit.module("Model > OhRule");
		QUnit.test("Constructor", function(assert) {
			assert.ok(new OhRule());
		});
		QUnit.test("Get date", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,1,2,4,5,6]);
			or.addDate(od1);
			assert.equal(or.getDate().length, 1);
			assert.equal(or.getDate()[0], od1);
		});
		QUnit.test("Get time", function(assert) {
			var or = new OhRule();
			assert.equal(or.getTime().length, 0);
			
			var ot1 = new OhTime(10, 60);
			or.addTime(ot1);
			assert.equal(or.getTime().length, 1);
			assert.equal(or.getTime()[0], ot1);
		});
		QUnit.test("Get simple", function(assert) {
			var or = new OhRule();
			
			var od1 = new OhDate("Apr 21-Aug 22", "day", [0,1,2,4,5,6]);
			or.addDate(od1);
			
			var ot1 = new OhTime(10, 60);
			or.addTime(ot1);
			
			assert.equal(or.get(), "Apr 21-Aug 22 Fr-We 00:10-01:00");
		});
		QUnit.test("Get several date/time", function(assert) {
			var or = new OhRule();
			
			var od1 = new OhDate("Mar", "month", [0,1,2,4,5,6]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1,2,4,5,6]);
			or.addDate(od1);
			or.addDate(od2);
			
			var ot1 = new OhTime(0, 1*60);
			var ot2 = new OhTime(3*60, 4*60);
			or.addTime(ot1);
			or.addTime(ot2);
			
			assert.equal(or.get(), "Mar,Jul-Oct Fr-We 00:00-01:00,03:00-04:00");
		});
		QUnit.test("Get time null", function(assert) {
			var or = new OhRule();
			
			var od1 = new OhDate("Mar", "month", [0,1,2,4,5,6]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1,2,4,5,6]);
			or.addDate(od1);
			or.addDate(od2);
			
			var ot1 = new OhTime();
			or.addTime(ot1);
			
			assert.equal(or.get(), "Mar,Jul-Oct Fr-We off");
		});
		QUnit.test("Get time completely null", function(assert) {
			var or = new OhRule();
			
			var od1 = new OhDate("Mar", "month", [0,1,2,4,5,6]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1,2,4,5,6]);
			or.addDate(od1);
			or.addDate(od2);

			assert.equal(or.get(), "Mar,Jul-Oct Fr-We off");
		});
		QUnit.test("Get date always", function(assert) {
			var or = new OhRule();
			
			var od1 = new OhDate("", "always", [0,1,2,4,5,6]);
			or.addDate(od1);
			
			var ot1 = new OhTime(0, 1*60);
			var ot2 = new OhTime(3*60, 4*60);
			or.addTime(ot1);
			or.addTime(ot2);
			
			assert.equal(or.get(), "Fr-We 00:00-01:00,03:00-04:00");
		});
		QUnit.test("Same time equal 1", function(assert) {
			var or1 = new OhRule();
			var or2 = new OhRule();
			
			var ot1 = new OhTime(10*60, 12*60);
			var ot2 = new OhTime(14*60, 16*60);
			
			or1.addTime(ot1);
			or1.addTime(ot2);
			
			or2.addTime(ot1);
			or2.addTime(ot2);
			
			assert.ok(or1.sameTime(or2));
			assert.ok(or2.sameTime(or1));
		});
		QUnit.test("Same time equal 2", function(assert) {
			var or1 = new OhRule();
			var or2 = new OhRule();
			
			var od1 = new OhDate("", "always", [0,1,2,3,4,5,6]);
			var od2 = new OhDate("Jun", "month", [3,4,5,6]);
			
			or1.addDate(od1);
			or2.addDate(od2);
			
			var ot1 = new OhTime(0, 24*60);
			var ot2 = new OhTime(0, 24*60);
			
			or1.addTime(ot1);
			or1.addTime(ot2);
			
			or2.addTime(ot1);
			or2.addTime(ot2);
			
			assert.ok(or1.sameTime(or2));
			assert.ok(or2.sameTime(or1));
		});
		QUnit.test("Same time different", function(assert) {
			var or1 = new OhRule();
			var or2 = new OhRule();
			
			var ot1 = new OhTime(10*60, 12*60);
			var ot2 = new OhTime(14*60, 16*60);
			var ot3 = new OhTime(14*60, 17*60);
			
			or1.addTime(ot1);
			or1.addTime(ot2);
			
			or2.addTime(ot1);
			or2.addTime(ot3);
			
			assert.notOk(or1.sameTime(or2));
			assert.notOk(or2.sameTime(or1));
		});
		QUnit.test("Add date simple", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("Mar", "month", [0,1,2,4,5,6]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1,2,4,5,6]);
			or.addDate(od1);
			or.addDate(od2);
			assert.equal(or.getDate().length, 2);
			assert.equal(or.getDate()[0], od1);
			assert.equal(or.getDate()[1], od2);
		});
		QUnit.test("Add date null", function(assert) {
			var or = new OhRule();
			
			try {
				or.addDate();
				assert.ok(false);
			}
			catch(e) {
				assert.expect(0);
			}
		});
		QUnit.test("Add date not same wide type", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("Mar", "month", [0,1,2,4,5,6]);
			var od2 = new OhDate("Apr 21", "day", [0,1,2,4,5,6]);
			or.addDate(od1);
			try {
				or.addDate(od2);
				assert.ok(false);
			}
			catch(e) {
				assert.equal(or.getDate().length, 1);
				assert.equal(or.getDate()[0], od1);
			}
		});
		QUnit.test("Add date not same weekdays", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("Mar", "month", [0,1,2,4,5,6]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1]);
			or.addDate(od1);
			assert.equal(or.getDate().length, 1);
			
			try {
				or.addDate(od2);
				assert.ok(false);
			}
			catch(e) {
				assert.equal(or.getDate().length, 1);
				assert.equal(or.getDate()[0], od1);
			}
		});
		QUnit.test("Add date full year", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("", "always", [0,1,2,4,5,6]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1,2,4,5,6]);
			or.addDate(od1);
			or.addDate(od2);
			assert.equal(or.getDate().length, 1);
		});
		QUnit.test("Add date full year not same weekdays", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("", "always", [0,1,2,4,5,6]);
			var od2 = new OhDate("Jul-Oct", "month", [6]);
			or.addDate(od1);
			assert.equal(or.getDate().length, 1);
			
			try {
				or.addDate(od2);
				assert.ok(false);
			}
			catch(e) {
				assert.equal(or.getDate().length, 1);
				assert.equal(or.getDate()[0], od1);
			}
		});
		QUnit.test("Add time off simple", function(assert) {
			var or = new OhRule();
			assert.equal(or.getTime().length, 0);
			
			var ot1 = new OhTime();
			or.addTime(ot1);
			assert.equal(or.getTime().length, 1);
		});
		QUnit.test("Add time off several", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var ot1 = new OhTime();
			var ot2 = new OhTime(0, 3*60);
			or.addTime(ot1);
			assert.equal(or.getTime().length, 1);
			try {
				or.addTime(ot2);
				assert.ok(false);
			}
			catch(e) {
				assert.equal(or.getTime().length, 1);
				assert.equal(or.getTime()[0], ot1);
			}
		});
		QUnit.test("Add time several", function(assert) {
			var or = new OhRule();
			assert.equal(or.getTime().length, 0);
			
			var ot1 = new OhTime(2*60, 3*60);
			var ot2 = new OhTime(5*60, 7*60);
			or.addTime(ot1);
			or.addTime(ot2);
			assert.equal(or.getTime().length, 2);
			assert.equal(or.getTime()[0], ot1);
			assert.equal(or.getTime()[1], ot2);
		});
		QUnit.test("Is off 1", function(assert) {
			var or = new OhRule();
			assert.equal(or.getTime().length, 0);
			
			assert.ok(or.isOff());
			
			var ot1 = new OhTime();
			or.addTime(ot1);
			assert.equal(or.getTime().length, 1);
			assert.equal(or.getTime()[0], ot1);

			assert.ok(or.isOff());
		});
		QUnit.test("Is off 2", function(assert) {
			var or = new OhRule();
			assert.equal(or.getTime().length, 0);
			
			assert.ok(or.isOff());
			
			var ot1 = new OhTime(5*60, 7*60);
			or.addTime(ot1);
			assert.equal(or.getTime().length, 1);
			assert.equal(or.getTime()[0], ot1);

			assert.notOk(or.isOff());
		});
		QUnit.test("Add weekday", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("Mar", "month", [0,1]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1]);
			or.addDate(od1);
			or.addDate(od2);
			assert.equal(or.getDate().length, 2);
			assert.equal(or.getDate()[0], od1);
			assert.equal(or.getDate()[1], od2);
			
			or.addWeekday(5);
			assert.equal(or.getDate().length, 2);
			assert.equal(or.getDate()[0].getWeekdays(), "Mo,Tu,Sa");
			assert.equal(or.getDate()[1].getWeekdays(), "Mo,Tu,Sa");
		});
		QUnit.test("Add overwritten weekday", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("Mar", "month", [0,1]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1]);
			or.addDate(od1);
			or.addDate(od2);
			assert.equal(or.getDate().length, 2);
			assert.equal(or.getDate()[0], od1);
			assert.equal(or.getDate()[1], od2);
			
			or.addOverwrittenWeekday(5);
			assert.equal(or.getDate().length, 2);
			assert.equal(or.getDate()[0].getWeekdays(), "Mo,Tu,Sa");
			assert.equal(or.getDate()[1].getWeekdays(), "Mo,Tu,Sa");
		});
		QUnit.test("Add PH weekday", function(assert) {
			var or = new OhRule();
			assert.equal(or.getDate().length, 0);
			
			var od1 = new OhDate("Mar", "month", [0,1]);
			var od2 = new OhDate("Jul-Oct", "month", [0,1]);
			or.addDate(od1);
			or.addDate(od2);
			assert.equal(or.getDate().length, 2);
			assert.equal(or.getDate()[0], od1);
			assert.equal(or.getDate()[1], od2);
			
			or.addPhWeekday();
			assert.equal(or.getDate().length, 2);
			assert.equal(or.getDate()[0].getWeekdays(), "PH,Mo,Tu");
			assert.equal(or.getDate()[1].getWeekdays(), "PH,Mo,Tu");
		});
		
		/*
		 * OpeningHoursBuilder
		 */
		QUnit.module("Model > OpeningHoursBuilder");
		QUnit.test("Build void", function(assert) {
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build([]), "");
		});
		QUnit.test("Build Mo 08:00-10:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 10*60));
			
			assert.equal(builder.build(dateranges), "Mo 08:00-10:00");
		});
		QUnit.test("Build Mo,We 08:00-10:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 10*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 8*60, 10*60));
			
			assert.equal(builder.build(dateranges), "Mo,We 08:00-10:00");
		});
		QUnit.test("Build Mo-We 08:00-10:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 10*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 8*60, 10*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 8*60, 10*60));
			
			assert.equal(builder.build(dateranges), "Mo-We 08:00-10:00");
		});
		QUnit.test("Build Mo-We 08:00-10:00; Sa,Su 07:00-13:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 10*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 8*60, 10*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 8*60, 10*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 7*60, 13*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 7*60, 13*60));
			
			assert.equal(builder.build(dateranges), "Mo-We 08:00-10:00; Sa,Su 07:00-13:00");
		});
		QUnit.test("Build Mo,Tu 23:00-03:00 continuous", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 1, 23*60, 3*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 2, 23*60, 3*60));
			
			assert.equal(builder.build(dateranges), "Mo,Tu 23:00-03:00");
		});
		QUnit.test("Build Mo,Tu 23:00-03:00 following", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 23*60, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 0, 3*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 23*60, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 0, 3*60));
			
			assert.equal(builder.build(dateranges), "Mo,Tu 23:00-03:00");
		});
		/*QUnit.test("Build Mo,Su 23:00-03:00 continuous", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 1, 23*60, 3*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 0, 23*60, 3*60));
			
			assert.equal(builder.build(dateranges), "Mo,Su 23:00-03:00");
		});*/
		QUnit.test("Build Mo,Su 23:00-03:00 following", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 23*60, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 0, 3*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 23*60, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 0, 3*60));
			
			assert.equal(builder.build(dateranges), "Mo,Su 23:00-03:00");
		});
		QUnit.test("Build Mo 08:00-10:00 merging", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 9*60));
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 9*60, 10*60));
			
			assert.equal(builder.build(dateranges), "Mo 08:00-10:00");
		});
		QUnit.test("Build Mo 08:00-24:00; Tu 00:00-09:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 1, 8*60, 9*60));
			
			assert.equal(builder.build(dateranges), "Mo 08:00-24:00; Tu 00:00-09:00");
		});
		QUnit.test("Build 08:00-18:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "08:00-18:00");
		});
		QUnit.test("Build 24/7 continuous", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			
			assert.equal(builder.build(dateranges), "24/7");
		});
		QUnit.test("Build 24/7 following", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 0, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 0, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 0, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 0, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 0, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 0, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 0, 24*60));
			
			assert.equal(builder.build(dateranges), "24/7");
		});
		QUnit.test("Build 24/7; Jun 08:00-18:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()), new DateRange(new WideInterval().month(6)) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 3, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(4, 4, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(5, 5, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(6, 6, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "24/7; Jun 08:00-18:00");
		});
		QUnit.test("Build 24/7; Jun 08:00-18:00; Jun We off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()), new DateRange(new WideInterval().month(6)) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 3, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(4, 4, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(5, 5, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(6, 6, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "24/7; Jun 08:00-18:00; Jun We off");
		});
		QUnit.test("Build 08:00-18:00; We off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "08:00-18:00; We off");
		});
		QUnit.test("Build 24/7; Jun Mo-We 08:00-18:00; Jun Th-Su off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()), new DateRange(new WideInterval().month(6)) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "24/7; Jun Mo-We 08:00-18:00; Jun Th-Su off");
		});
		QUnit.test("Build 24/7; Jun Mo-We 08:00-18:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()), new DateRange(new WideInterval().month(6)) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 6, 0, 24*60));
			
			assert.equal(builder.build(dateranges), "24/7; Jun Mo-We 08:00-18:00");
		});
		QUnit.test("Build 24/7; Jun-Aug Mo-We 08:00-18:00; Jun-Aug Th-Su off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()), new DateRange(new WideInterval().month(6, 8)) ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "24/7; Jun-Aug Mo-We 08:00-18:00; Jun-Aug Th-Su off");
		});
		QUnit.test("Build 24/7; Jun Mo 08:00-18:00; Jun Tu-Su off; PH off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().month(6)),
				new DateRange(new WideInterval().holiday("PH"))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "24/7; Jun Mo 08:00-18:00; Jun Tu-Su off; PH off");
		});
		QUnit.test("Build 24/7; Jun Mo 08:00-18:00; Jun Tu-Su off; PH off; SH Tu 09:00-17:00; SH Mo,We-Su off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().month(6)),
				new DateRange(new WideInterval().holiday("PH")),
				new DateRange(new WideInterval().holiday("SH"))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[3].getTypical().addInterval(new Interval(1, 1, 9*60, 17*60));
			
			assert.equal(builder.build(dateranges), "24/7; Jun Mo 08:00-18:00; Jun Tu-Su off; PH off; SH We-Mo off; SH Tu 09:00-17:00");
		});
		QUnit.test("Build Mo 08:00-18:00 grouping", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().month(6)),
				new DateRange(new WideInterval().holiday("SH"))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[2].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "Mo 08:00-18:00");
		});
		QUnit.test("Build 24/7; week 01-15 We 05:00-07:00; PH off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().week(1, 15)),
				new DateRange(new WideInterval().holiday("PH"))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 1, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 5*60, 7*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 6, 0, 24*60));
			
			assert.equal(builder.build(dateranges), "24/7; week 01-15 We 05:00-07:00; PH off");
		});
		QUnit.test("Build 24/7; week 01-15 Fr-We 05:00-07:00; PH off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().week(1, 15)),
				new DateRange(new WideInterval().holiday("PH"))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 5*60, 7*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 5*60, 7*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 5*60, 7*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 3, 0, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(4, 4, 5*60, 7*60));
			dateranges[1].getTypical().addInterval(new Interval(5, 5, 5*60, 7*60));
			dateranges[1].getTypical().addInterval(new Interval(6, 6, 5*60, 7*60));
			
			assert.equal(builder.build(dateranges), "24/7; week 01-15 Fr-We 05:00-07:00; PH off");
		});
		QUnit.test("Build 05:00-07:00; Th,Fr 00:00-24:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always())
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 5*60, 7*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 5*60, 7*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 5*60, 7*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 0, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 0, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 5*60, 7*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 5*60, 7*60));
			
			assert.equal(builder.build(dateranges), "05:00-07:00; Th,Fr 00:00-24:00");
		});
		QUnit.test("Build Mo-Fr 01:00-02:00; We off; Jun We 02:00-03:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().month(6))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 2*60, 3*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 3, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(4, 4, 1*60, 2*60));
			
			assert.equal(builder.build(dateranges), "Mo-Fr 01:00-02:00; We off; Jun We 02:00-03:00");
		});
		QUnit.test("Build 01:00-02:00; Jun Th 02:00-03:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().month(6))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 1*60, 2*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 3, 2*60, 3*60));
			dateranges[1].getTypical().addInterval(new Interval(4, 4, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(5, 5, 1*60, 2*60));
			dateranges[1].getTypical().addInterval(new Interval(6, 6, 1*60, 2*60));
			
			assert.equal(builder.build(dateranges), "01:00-02:00; Jun Th 02:00-03:00");
		});
		QUnit.test("Build 24/7; week 01 Su 01:00-08:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().week(1))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0*60, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 5, 0*60, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(6, 6, 1*60, 8*60));
			
			assert.equal(builder.build(dateranges), "24/7; week 01 Su 01:00-08:00");
		});
		QUnit.test("Build 24/7; week 01 Su 01:00-08:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().week(1))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 6, 0*60, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 5, 0*60, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(6, 6, 1*60, 8*60));
			
			assert.equal(builder.build(dateranges), "24/7; week 01 Su 01:00-08:00");
		});
		QUnit.test("Build Tu,Su 23:00-01:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always())
			];
			
			dateranges[0].getTypical().addInterval(new Interval(1, 2, 23*60, 1*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 23*60, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 0*60, 1*60));
			
			assert.equal(builder.build(dateranges), "Tu,Su 23:00-01:00");
		});
		QUnit.test("Build Tu,Su 23:00-01:00; week 01 Tu,We off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().week(1))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(1, 2, 23*60, 1*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 23*60, 24*60));
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 0*60, 1*60));
			dateranges[1].getTypical().addInterval(new Interval(6, 6, 23*60, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 0*60, 1*60));
			
			assert.equal(builder.build(dateranges), "Tu,Su 23:00-01:00; week 01 Tu,We off");
		});
		QUnit.test("Build 08:00-18:00; Aug off", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().month(8))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "08:00-18:00; Aug off");
		});
		QUnit.test("Build Mo 10:00; PH 11:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().holiday("PH"))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 10*60, 10*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 11*60, 11*60));
			
			assert.equal(builder.build(dateranges), "Mo 10:00; PH 11:00");
		});
		QUnit.test("Build Mo-Fr 00:00-24:00; Aug-Sep Sa 00:00-24:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().always()),
				new DateRange(new WideInterval().month(8,9))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 4, 0*60, 24*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 5, 0*60, 24*60));
			
			assert.equal(builder.build(dateranges), "Mo-Fr 00:00-24:00; Aug-Sep Sa 00:00-24:00");
		});
		QUnit.test("Build May-Jun,Sep 14:00-18:00 (month factoring)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().month(5,6)),
				new DateRange(new WideInterval().month(9))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 14*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 14*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 14*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 14*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 14*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 14*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 3, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(4, 4, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(5, 5, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(6, 6, 14*60, 18*60));
			
			assert.equal(builder.build(dateranges), "May-Jun,Sep 14:00-18:00");
		});
		QUnit.test("Build Jan 01-May 01,May 15-Oct 12 Mo,Fr 08:00-18:00 (day factoring)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().day(1,1,1,5)),
				new DateRange(new WideInterval().day(15,5,12,10))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 8*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(4, 4, 8*60, 18*60));
			
			assert.equal(builder.build(dateranges), "Jan 01-May 01,May 15-Oct 12 Mo,Fr 08:00-18:00");
		});
		QUnit.test("Build Mo-We 03:00-05:00; Jan 01-10,Feb 01-10 Tu off (off day factoring)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(),
				new DateRange(new WideInterval().day(1,1,10,1)),
				new DateRange(new WideInterval().day(1,2,10,2))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 3*60, 5*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 3*60, 5*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 3*60, 5*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 3*60, 5*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 3*60, 5*60));
			dateranges[2].getTypical().addInterval(new Interval(0, 0, 3*60, 5*60));
			dateranges[2].getTypical().addInterval(new Interval(2, 2, 3*60, 5*60));
			
			assert.equal(builder.build(dateranges), "Mo-We 03:00-05:00; Jan 01-10,Feb 01-10 Tu off");
		});
		QUnit.test("Build Tu,Su 10:00-12:00; Jun Tu,Su off; Jun We,Sa 10:00-12:00 (off day factoring)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(),
				new DateRange(new WideInterval().month(6))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 10*60, 12*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 10*60, 12*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 10*60, 12*60));
			dateranges[1].getTypical().addInterval(new Interval(5, 5, 10*60, 12*60));
			
			assert.equal(builder.build(dateranges), "Tu,Su 10:00-12:00; Jun Tu,Su off; Jun We,Sa 10:00-12:00");
		});
		QUnit.test("Build week 01-09 Mo 03:00-06:00 (week factoring)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().week(1,2)),
				new DateRange(new WideInterval().week(3,9))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 3*60, 6*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 3*60, 6*60));
			
			assert.equal(builder.build(dateranges), "week 01-09 Mo 03:00-06:00");
		});
		QUnit.test("Build week 01-03,10-15 Mo 03:00-06:00 (week factoring)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().week(1,3)),
				new DateRange(new WideInterval().week(10,15))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 3*60, 6*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 3*60, 6*60));
			
			assert.equal(builder.build(dateranges), "week 01-09 Mo 03:00-06:00");
		});
		QUnit.test("Build May-Jun,Sep Mo,Tu 14:00-18:00 (month factoring)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().month(5,6)),
				new DateRange(new WideInterval().month(9))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 14*60, 18*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 14*60, 18*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 14*60, 18*60));
			
			assert.equal(builder.build(dateranges), "May-Jun,Sep Mo,Tu 14:00-18:00");
		});
		QUnit.test("Build Mo-Fr 12:00-14:00; PH,Sa,Su 12:00-16:00 (PH as weekday)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(),
				new DateRange(new WideInterval().holiday("PH"))
			];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 12*60, 14*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 12*60, 14*60));
			dateranges[0].getTypical().addInterval(new Interval(2, 2, 12*60, 14*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 12*60, 14*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 12*60, 14*60));
			dateranges[0].getTypical().addInterval(new Interval(5, 5, 12*60, 16*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 12*60, 16*60));
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 12*60, 16*60));
			
			
			assert.equal(builder.build(dateranges), "Mo-Fr 12:00-14:00; PH,Sa,Su 12:00-16:00");
		});
		QUnit.test("Build PH,Mo-Sa 12:00-14:00 (PH as weekday defined first)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [
				new DateRange(new WideInterval().holiday("PH")),
				new DateRange()
			];
			
			dateranges[1].getTypical().addInterval(new Interval(0, 0, 12*60, 14*60));
			dateranges[1].getTypical().addInterval(new Interval(1, 1, 12*60, 14*60));
			dateranges[1].getTypical().addInterval(new Interval(2, 2, 12*60, 14*60));
			dateranges[1].getTypical().addInterval(new Interval(3, 3, 12*60, 14*60));
			dateranges[1].getTypical().addInterval(new Interval(4, 4, 12*60, 14*60));
			dateranges[1].getTypical().addInterval(new Interval(5, 5, 12*60, 14*60));
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 12*60, 14*60));
			
			
			assert.equal(builder.build(dateranges), "PH,Mo-Sa 12:00-14:00");
		});
		QUnit.test("Build Su-Tu 12:00-14:00 (continuous week-end)", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange() ];
			
			dateranges[0].getTypical().addInterval(new Interval(0, 0, 12*60, 14*60));
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 12*60, 14*60));
			dateranges[0].getTypical().addInterval(new Interval(6, 6, 12*60, 14*60));
			
			
			assert.equal(builder.build(dateranges), "Su-Tu 12:00-14:00");
		});
		QUnit.test("Build Tu 00:00-24:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange() ];
			
			dateranges[0].getTypical().addInterval(new Interval(1, 1, 0*60, 24*60));
			
			assert.equal(builder.build(dateranges), "Tu 00:00-24:00");
		});
		QUnit.test("Build Tu,Th,Fr 08:00-12:00", function(assert) {
			var builder = new OpeningHoursBuilder();
			var dateranges = [ new DateRange(new WideInterval().always()) ];

			dateranges[0].getTypical().addInterval(new Interval(1, 1, 8*60, 12*60));
			dateranges[0].getTypical().addInterval(new Interval(3, 3, 8*60, 12*60));
			dateranges[0].getTypical().addInterval(new Interval(4, 4, 8*60, 12*60));

			assert.equal(builder.build(dateranges), "Tu-Fr 08:00-12:00; We off");
		});
		
		/*
		 * OpeningHoursParser
		 */
		QUnit.module("Model > OpeningHoursParser");
		QUnit.test("Parse Mo 08:00-10:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo 08:00-10:00")), "Mo 08:00-10:00");
		});
		QUnit.test("Parse Mo,We 08:00-10:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo,We 08:00-10:00")), "Mo,We 08:00-10:00");
		});
		QUnit.test("Parse Mo-We 08:00-10:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo-We 08:00-10:00")), "Mo-We 08:00-10:00");
		});
		QUnit.test("Parse Mo-We 08:00-10:00; Sa,Su 07:00-13:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo-We 08:00-10:00; Sa,Su 07:00-13:00")), "Mo-We 08:00-10:00; Sa,Su 07:00-13:00");
		});
		QUnit.test("Parse Mo,Tu 23:00-03:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			
			var result = parser.parse("Mo,Tu 23:00-03:00");
			assert.equal(result.length, 1);
			assert.equal(result[0].getInterval().getStart(), null);
			assert.equal(result[0].getTypical().getIntervals().length, 2);
			
			assert.equal(result[0].getTypical().getIntervals()[0].getStartDay(), 0);
			assert.equal(result[0].getTypical().getIntervals()[0].getEndDay(), 1);
			assert.equal(result[0].getTypical().getIntervals()[0].getFrom(), 23*60);
			assert.equal(result[0].getTypical().getIntervals()[0].getTo(), 3*60);
			assert.equal(result[0].getTypical().getIntervals()[1].getStartDay(), 1);
			assert.equal(result[0].getTypical().getIntervals()[1].getEndDay(), 2);
			assert.equal(result[0].getTypical().getIntervals()[1].getFrom(), 23*60);
			assert.equal(result[0].getTypical().getIntervals()[1].getTo(), 3*60);
			
			assert.equal(builder.build(result), "Mo,Tu 23:00-03:00");
		});
		QUnit.test("Parse Mo 08:00-10:00 merging", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo 08:00-09:00,09:00-10:00")), "Mo 08:00-10:00");
		});
		QUnit.test("Parse Mo 08:00-24:00; Tu 00:00-09:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo 08:00-24:00; Tu 00:00-09:00")), "Mo 08:00-24:00; Tu 00:00-09:00");
		});
		QUnit.test("Parse 08:00-18:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("08:00-18:00")), "08:00-18:00");
		});
		QUnit.test("Parse 24/7 continuous", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("24/7")), "24/7");
		});
		QUnit.test("Parse 24/7 following", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo-Su 00:00-24:00")), "24/7");
		});
		QUnit.test("Parse 24/7; Jun: 08:00-18:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("24/7; Jun: 08:00-18:00")), "24/7; Jun 08:00-18:00");
		});
		QUnit.test("Parse 24/7; Jun: 08:00-18:00; Jun: We off", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("24/7; Jun: 08:00-18:00; Jun: We off")), "24/7; Jun 08:00-18:00; Jun We off");
		});
		QUnit.test("Parse 24/7; Jun: Mo-We 08:00-18:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("24/7; Jun: Mo-We 08:00-18:00")), "24/7; Jun Mo-We 08:00-18:00");
		});
		QUnit.test("Parse 24/7; Jun-Aug: Mo-We 08:00-18:00; Jun-Aug: Th-Su off", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("24/7; Jun-Aug: Mo-We 08:00-18:00; Jun-Aug: Th-Su off")), "24/7; Jun-Aug Mo-We 08:00-18:00; Jun-Aug Th-Su off");
		});
		QUnit.test("Parse 24/7; Jun: Mo 08:00-18:00; Jun: Tu-Su off; PH off", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("24/7; Jun: Mo 08:00-18:00; Jun: Tu-Su off; PH off")), "24/7; Jun Mo 08:00-18:00; Jun Tu-Su off; PH off");
		});
		QUnit.test("Parse 24/7; Jun: Mo 08:00-18:00; PH off; SH Tu 09:00-17:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			
			var result = parser.parse("24/7; Jun: Mo 08:00-18:00; PH off; SH Tu 09:00-17:00");
			assert.equal(result.length, 4);
			
			var dr1 = result[0];
			assert.equal(dr1.getInterval().getTimeSelector(), "");
			
			var dr2 = result[1];
			assert.equal(dr2.getInterval().getTimeSelector(), "Jun");
			
			var dr3 = result[2];
			assert.equal(dr3.getInterval().getTimeSelector(), "PH");
			
			var dr4 = result[3];
			assert.equal(dr4.getInterval().getTimeSelector(), "SH");
			assert.equal(dr4.getTypical().getIntervals().length, 8);
			
			assert.equal(dr4.getTypical().getIntervals()[0].getStartDay(), 0);
			assert.equal(dr4.getTypical().getIntervals()[0].getEndDay(), 0);
			assert.equal(dr4.getTypical().getIntervals()[0].getFrom(), 0*60);
			assert.equal(dr4.getTypical().getIntervals()[0].getTo(), 24*60);
			
			assert.equal(dr4.getTypical().getIntervals()[1], undefined);
			
			assert.equal(dr4.getTypical().getIntervals()[2].getStartDay(), 2);
			assert.equal(dr4.getTypical().getIntervals()[2].getEndDay(), 2);
			assert.equal(dr4.getTypical().getIntervals()[2].getFrom(), 0*60);
			assert.equal(dr4.getTypical().getIntervals()[2].getTo(), 24*60);
			
			assert.equal(dr4.getTypical().getIntervals()[3].getStartDay(), 3);
			assert.equal(dr4.getTypical().getIntervals()[3].getEndDay(), 3);
			assert.equal(dr4.getTypical().getIntervals()[3].getFrom(), 0*60);
			assert.equal(dr4.getTypical().getIntervals()[3].getTo(), 24*60);
			
			assert.equal(dr4.getTypical().getIntervals()[4].getStartDay(), 4);
			assert.equal(dr4.getTypical().getIntervals()[4].getEndDay(), 4);
			assert.equal(dr4.getTypical().getIntervals()[4].getFrom(), 0*60);
			assert.equal(dr4.getTypical().getIntervals()[4].getTo(), 24*60);
			
			assert.equal(dr4.getTypical().getIntervals()[5].getStartDay(), 5);
			assert.equal(dr4.getTypical().getIntervals()[5].getEndDay(), 5);
			assert.equal(dr4.getTypical().getIntervals()[5].getFrom(), 0*60);
			assert.equal(dr4.getTypical().getIntervals()[5].getTo(), 24*60);
			
			assert.equal(dr4.getTypical().getIntervals()[6].getStartDay(), 6);
			assert.equal(dr4.getTypical().getIntervals()[6].getEndDay(), 6);
			assert.equal(dr4.getTypical().getIntervals()[6].getFrom(), 0*60);
			assert.equal(dr4.getTypical().getIntervals()[6].getTo(), 24*60);
			
			assert.equal(dr4.getTypical().getIntervals()[7].getStartDay(), 1);
			assert.equal(dr4.getTypical().getIntervals()[7].getEndDay(), 1);
			assert.equal(dr4.getTypical().getIntervals()[7].getFrom(), 9*60);
			assert.equal(dr4.getTypical().getIntervals()[7].getTo(), 17*60);
			
			assert.equal(builder.build(result), "24/7; Jun Mo 08:00-18:00; PH off; SH Tu 09:00-17:00");
		});
		QUnit.test("Parse Mo 08:00-18:00 grouping", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo 08:00-18:00; Jun: Mo 08:00-18:00; SH Mo 08:00-18:00")), "Mo 08:00-18:00");
		});
		QUnit.test("Parse week 01-15: We 05:00-07:00; PH off", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("week 01-15: We 05:00-07:00; PH off")), "week 01-15 We 05:00-07:00; PH off");
		});
		QUnit.test("Parse Mo 08:00-18:00; ; Tu 09:00-18:00 (empty rule)", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo 08:00-18:00; ; Tu 09:00-18:00")), "Mo 08:00-18:00; Tu 09:00-18:00");
		});
		QUnit.test("Parse 01:00-02:00; Jun: Th 02:00-03:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("01:00-02:00; Jun: Th 02:00-03:00")), "01:00-02:00; Jun Th 02:00-03:00");
		});
		QUnit.test("Parse Tu 00:00-24:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			
			var result = parser.parse("Tu 00:00-24:00");
			assert.equal(result.length, 1);
			
			var dr1 = result[0];
			assert.equal(dr1.getInterval().getTimeSelector(), "");
			assert.equal(dr1.getTypical().getIntervals().length, 1);
			
			assert.equal(dr1.getTypical().getIntervals()[0].getStartDay(), 1);
			assert.equal(dr1.getTypical().getIntervals()[0].getEndDay(), 1);
			assert.equal(dr1.getTypical().getIntervals()[0].getFrom(), 0*60);
			assert.equal(dr1.getTypical().getIntervals()[0].getTo(), 24*60);
			
			assert.equal(builder.build(result), "Tu 00:00-24:00");
		});
		QUnit.test("Parse 24/7; week 01: Su 01:00-08:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("24/7; week 01: Su 01:00-08:00")), "24/7; week 01 Su 01:00-08:00");
		});
		QUnit.test("Parse Mo 10:00; PH 11:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo 10:00; PH 11:00")), "Mo 10:00; PH 11:00");
		});
		QUnit.test("Parse unsupported 24/7; week 01: Su 01:00-08:00 || \"on appointment\"", function(assert) {
			var parser = new OpeningHoursParser();
			try {
				assert.notOk(parser.parse("24/7; week 01: Su 01:00-08:00 || \"on appointment\"") instanceof Array);
			}
			catch(e) {
				assert.ok(true);
			}
		});
		QUnit.test("Parse SH 08:00-18:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			
			var result = parser.parse("SH 08:00-18:00");
			assert.equal(result.length, 1);
			
			var dr1 = result[0];
			assert.equal(dr1.getInterval().getTimeSelector(), "SH");
			assert.equal(dr1.getTypical().getIntervals().length, 7);
			
			assert.equal(dr1.getTypical().getIntervals()[0].getStartDay(), 0);
			assert.equal(dr1.getTypical().getIntervals()[0].getEndDay(), 0);
			assert.equal(dr1.getTypical().getIntervals()[0].getFrom(), 8*60);
			assert.equal(dr1.getTypical().getIntervals()[0].getTo(), 18*60);
			assert.equal(dr1.getTypical().getIntervals()[1].getStartDay(), 1);
			assert.equal(dr1.getTypical().getIntervals()[1].getEndDay(), 1);
			assert.equal(dr1.getTypical().getIntervals()[1].getFrom(), 8*60);
			assert.equal(dr1.getTypical().getIntervals()[1].getTo(), 18*60);
			assert.equal(dr1.getTypical().getIntervals()[2].getStartDay(), 2);
			assert.equal(dr1.getTypical().getIntervals()[2].getEndDay(), 2);
			assert.equal(dr1.getTypical().getIntervals()[2].getFrom(), 8*60);
			assert.equal(dr1.getTypical().getIntervals()[2].getTo(), 18*60);
			assert.equal(dr1.getTypical().getIntervals()[3].getStartDay(), 3);
			assert.equal(dr1.getTypical().getIntervals()[3].getEndDay(), 3);
			assert.equal(dr1.getTypical().getIntervals()[3].getFrom(), 8*60);
			assert.equal(dr1.getTypical().getIntervals()[3].getTo(), 18*60);
			assert.equal(dr1.getTypical().getIntervals()[4].getStartDay(), 4);
			assert.equal(dr1.getTypical().getIntervals()[4].getEndDay(), 4);
			assert.equal(dr1.getTypical().getIntervals()[4].getFrom(), 8*60);
			assert.equal(dr1.getTypical().getIntervals()[4].getTo(), 18*60);
			assert.equal(dr1.getTypical().getIntervals()[5].getStartDay(), 5);
			assert.equal(dr1.getTypical().getIntervals()[5].getEndDay(), 5);
			assert.equal(dr1.getTypical().getIntervals()[5].getFrom(), 8*60);
			assert.equal(dr1.getTypical().getIntervals()[5].getTo(), 18*60);
			assert.equal(dr1.getTypical().getIntervals()[6].getStartDay(), 6);
			assert.equal(dr1.getTypical().getIntervals()[6].getEndDay(), 6);
			assert.equal(dr1.getTypical().getIntervals()[6].getFrom(), 8*60);
			assert.equal(dr1.getTypical().getIntervals()[6].getTo(), 18*60);
			
			assert.equal(builder.build(result), "SH 08:00-18:00");
		});
		QUnit.test("Parse Mo-Fr 12:00-14:00; Sa,Su,PH 12:00-16:00 (PH as weekday)", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Mo-Fr 12:00-14:00; Sa,Su,PH 12:00-16:00")), "Mo-Fr 12:00-14:00; PH,Sa,Su 12:00-16:00");
		});
		QUnit.test("Parse Su-Tu 12:00-14:00 (continous week-end)", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			assert.equal(builder.build(parser.parse("Su-Tu 12:00-14:00")), "Su-Tu 12:00-14:00");
		});
		QUnit.test("Parse Mo-Sa,PH 12:00-16:00", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			
			var result = parser.parse("Mo-Sa,PH 12:00-16:00");
			assert.equal(result.length, 2);
			
			var dr1 = result[1];
			assert.equal(dr1.getInterval().getTimeSelector(), "");
			assert.equal(dr1.getTypical().getIntervals().length, 6);
			
			assert.equal(dr1.getTypical().getIntervals()[0].getStartDay(), 0);
			assert.equal(dr1.getTypical().getIntervals()[0].getEndDay(), 0);
			assert.equal(dr1.getTypical().getIntervals()[0].getFrom(), 12*60);
			assert.equal(dr1.getTypical().getIntervals()[0].getTo(), 16*60);
			
			var dr2 = result[0];
			assert.equal(dr2.getInterval().getTimeSelector(), "PH");
			assert.equal(dr2.getTypical().getIntervals().length, 1);
			
			assert.equal(dr2.getTypical().getIntervals()[0].getStartDay(), 0);
			assert.equal(dr2.getTypical().getIntervals()[0].getEndDay(), 0);
			assert.equal(dr2.getTypical().getIntervals()[0].getFrom(), 12*60);
			assert.equal(dr2.getTypical().getIntervals()[0].getTo(), 16*60);
			
			assert.equal(builder.build(result), "PH,Mo-Sa 12:00-16:00");
		});
		QUnit.test("Parse Mo 04:00-08:00; PH off", function(assert) {
			var parser = new OpeningHoursParser();
			var builder = new OpeningHoursBuilder();
			
			var result = parser.parse("Mo 04:00-08:00; PH off");
			assert.equal(builder.build(result), "Mo 04:00-08:00; PH off");
		});
		
		/*
		 * YoHoursChecker
		 */
		QUnit.module("Model > YoHoursChecker");
		QUnit.test("Check valid", function(assert) {
			var checker = new YoHoursChecker();
			assert.ok(checker.canRead("24/7; week 01: Su 01:00-08:00"));
		});
		QUnit.test("Check invalid", function(assert) {
			var checker = new YoHoursChecker();
			assert.notOk(checker.canRead("24/7; week 01: Su 01:00-08:00 || \"on appointment\""));
			assert.notOk(checker.canRead("not valid oh string"));
			assert.notOk(checker.canRead("nothing"));
			assert.notOk(checker.canRead("24/24, 7/7"));
		});
	</script>
</head>
<body>
	<div id="qunit"></div>
</body>
</html>